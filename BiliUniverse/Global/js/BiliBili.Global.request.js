class e{static name="Lodash";static version="1.2.2";static about(){return console.log(`\nðŸŸ§ ${this.name} v${this.version}\n`)}static get(e={},t="",a=void 0){Array.isArray(t)||(t=this.toPath(t));const s=t.reduce(((e,t)=>Object(e)[t]),e);return void 0===s?a:s}static set(e={},t="",a){return Array.isArray(t)||(t=this.toPath(t)),t.slice(0,-1).reduce(((e,a,s)=>Object(e[a])===e[a]?e[a]:e[a]=/^\d+$/.test(t[s+1])?[]:{}),e)[t[t.length-1]]=a,e}static unset(e={},t=""){return Array.isArray(t)||(t=this.toPath(t)),t.reduce(((e,a,s)=>s===t.length-1?(delete e[a],!0):Object(e)[a]),e)}static toPath(e){return e.replace(/\[(\d+)\]/g,".$1").split(".").filter(Boolean)}static escape(e){const t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};return e.replace(/[&<>"']/g,(e=>t[e]))}static unescape(e){const t={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"};return e.replace(/&amp;|&lt;|&gt;|&quot;|&#39;/g,(e=>t[e]))}}class t{static name="$Storage";static version="1.0.9";static about(){return console.log(`\nðŸŸ§ ${this.name} v${this.version}\n`)}static data=null;static dataFile="box.dat";static#e=/^@(?<key>[^.]+)(?:\.(?<path>.*))?$/;static#t(){return"undefined"!=typeof $environment&&$environment["surge-version"]?"Surge":"undefined"!=typeof $environment&&$environment["stash-version"]?"Stash":"undefined"!=typeof module&&module.exports?"Node.js":"undefined"!=typeof $task?"Quantumult X":"undefined"!=typeof $loon?"Loon":"undefined"!=typeof $rocket?"Shadowrocket":"undefined"!=typeof Egern?"Egern":void 0}static getItem(t=new String,a=null){let s=a;if(!0===t.startsWith("@")){const{key:a,path:n}=t.match(this.#e)?.groups;t=a;let r=this.getItem(t,{});"object"!=typeof r&&(r={}),s=e.get(r,n);try{s=JSON.parse(s)}catch(e){}}else{switch(this.#t()){case"Surge":case"Loon":case"Stash":case"Egern":case"Shadowrocket":s=$persistentStore.read(t);break;case"Quantumult X":s=$prefs.valueForKey(t);break;case"Node.js":this.data=this.#a(this.dataFile),s=this.data?.[t];break;default:s=this.data?.[t]||null}try{s=JSON.parse(s)}catch(e){}}return s??a}static setItem(t=new String,a=new String){let s=!1;if("object"==typeof a)a=JSON.stringify(a);else a=String(a);if(!0===t.startsWith("@")){const{key:n,path:r}=t.match(this.#e)?.groups;t=n;let i=this.getItem(t,{});"object"!=typeof i&&(i={}),e.set(i,r,a),s=this.setItem(t,i)}else switch(this.#t()){case"Surge":case"Loon":case"Stash":case"Egern":case"Shadowrocket":s=$persistentStore.write(a,t);break;case"Quantumult X":s=$prefs.setValueForKey(a,t);break;case"Node.js":this.data=this.#a(this.dataFile),this.data[t]=a,this.#s(this.dataFile),s=!0;break;default:s=this.data?.[t]||null}return s}static removeItem(t){let a=!1;if(!0===t.startsWith("@")){const{key:s,path:n}=t.match(this.#e)?.groups;t=s;let r=this.getItem(t);"object"!=typeof r&&(r={}),keyValue=e.unset(r,n),a=this.setItem(t,r)}else switch(this.#t()){case"Surge":case"Loon":case"Stash":case"Egern":case"Shadowrocket":case"Node.js":default:a=!1;break;case"Quantumult X":a=$prefs.removeValueForKey(t)}return a}static clear(){let e=!1;switch(this.#t()){case"Surge":case"Loon":case"Stash":case"Egern":case"Shadowrocket":case"Node.js":default:e=!1;break;case"Quantumult X":e=$prefs.removeAllValues()}return e}static#a(e){if(!this.isNode())return{};{this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(e),a=this.path.resolve(process.cwd(),e),s=this.fs.existsSync(t),n=!s&&this.fs.existsSync(a);if(!s&&!n)return{};{const e=s?t:a;try{return JSON.parse(this.fs.readFileSync(e))}catch(e){return{}}}}}static#s(e=this.dataFile){if(this.isNode()){this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(e),a=this.path.resolve(process.cwd(),e),s=this.fs.existsSync(t),n=!s&&this.fs.existsSync(a),r=JSON.stringify(this.data);s?this.fs.writeFileSync(t,r):n?this.fs.writeFileSync(a,r):this.fs.writeFileSync(t,r)}}}class a{static name="ENV";static version="1.8.3";static about(){return console.log(`\nðŸŸ§ ${this.name} v${this.version}\n`)}constructor(e,t){console.log(`\nðŸŸ§ ${a.name} v${a.version}\n`),this.name=e,this.logs=[],this.isMute=!1,this.isMuteLog=!1,this.logSeparator="\n",this.encoding="utf-8",this.startTime=(new Date).getTime(),Object.assign(this,t),this.log(`\nðŸš© å¼€å§‹!\n${e}\n`)}environment(){switch(this.platform()){case"Surge":return $environment.app="Surge",$environment;case"Stash":return $environment.app="Stash",$environment;case"Egern":return $environment.app="Egern",$environment;case"Loon":let e=$loon.split(" ");return{device:e[0],ios:e[1],"loon-version":e[2],app:"Loon"};case"Quantumult X":return{app:"Quantumult X"};case"Node.js":return process.env.app="Node.js",process.env;default:return{}}}platform(){return"undefined"!=typeof $environment&&$environment["surge-version"]?"Surge":"undefined"!=typeof $environment&&$environment["stash-version"]?"Stash":"undefined"!=typeof module&&module.exports?"Node.js":"undefined"!=typeof $task?"Quantumult X":"undefined"!=typeof $loon?"Loon":"undefined"!=typeof $rocket?"Shadowrocket":"undefined"!=typeof Egern?"Egern":void 0}isNode(){return"Node.js"===this.platform()}isQuanX(){return"Quantumult X"===this.platform()}isSurge(){return"Surge"===this.platform()}isLoon(){return"Loon"===this.platform()}isShadowrocket(){return"Shadowrocket"===this.platform()}isStash(){return"Stash"===this.platform()}isEgern(){return"Egern"===this.platform()}async getScript(e){return await this.fetch(e).then((e=>e.body))}async runScript(e,a){let s=t.getItem("@chavy_boxjs_userCfgs.httpapi");s=s?.replace?.(/\n/g,"")?.trim();let n=t.getItem("@chavy_boxjs_userCfgs.httpapi_timeout");n=1*n??20,n=a?.timeout??n;const[r,i]=s.split("@"),o={url:`http://${i}/v1/scripting/evaluate`,body:{script_text:e,mock_type:"cron",timeout:n},headers:{"X-Key":r,Accept:"*/*"},timeout:n};await this.fetch(o).then((e=>e.body),(e=>this.logErr(e)))}initGotEnv(e){this.got=this.got?this.got:require("got"),this.cktough=this.cktough?this.cktough:require("tough-cookie"),this.ckjar=this.ckjar?this.ckjar:new this.cktough.CookieJar,e&&(e.headers=e.headers?e.headers:{},void 0===e.headers.Cookie&&void 0===e.cookieJar&&(e.cookieJar=this.ckjar))}async fetch(t={}||"",a={}){switch(t.constructor){case Object:t={...a,...t};break;case String:t={...a,url:t}}t.method||(t.method="GET",(t.body??t.bodyBytes)&&(t.method="POST")),delete t.headers?.Host,delete t.headers?.[":authority"],delete t.headers?.["Content-Length"],delete t.headers?.["content-length"];const s=t.method.toLocaleLowerCase();switch(this.platform()){case"Loon":case"Surge":case"Stash":case"Egern":case"Shadowrocket":default:return t.timeout&&(t.timeout=parseInt(t.timeout,10),this.isSurge()||(t.timeout=1e3*t.timeout)),t.policy&&(this.isLoon()&&(t.node=t.policy),this.isStash()&&e.set(t,"headers.X-Stash-Selected-Proxy",encodeURI(t.policy)),this.isShadowrocket()&&e.set(t,"headers.X-Surge-Proxy",t.policy)),"boolean"==typeof t.redirection&&(t["auto-redirect"]=t.redirection),t.bodyBytes&&!t.body&&(t.body=t.bodyBytes,delete t.bodyBytes),await new Promise(((e,a)=>{$httpClient[s](t,((s,n,r)=>{s?a(s):(n.ok=/^2\d\d$/.test(n.status),n.statusCode=n.status,r&&(n.body=r,1==t["binary-mode"]&&(n.bodyBytes=r)),e(n))}))}));case"Quantumult X":return t.policy&&e.set(t,"opts.policy",t.policy),"boolean"==typeof t["auto-redirect"]&&e.set(t,"opts.redirection",t["auto-redirect"]),t.body instanceof ArrayBuffer?(t.bodyBytes=t.body,delete t.body):ArrayBuffer.isView(t.body)?(t.bodyBytes=t.body.buffer.slice(t.body.byteOffset,t.body.byteLength+t.body.byteOffset),delete object.body):t.body&&delete t.bodyBytes,await $task.fetch(t).then((e=>(e.ok=/^2\d\d$/.test(e.statusCode),e.status=e.statusCode,e)),(e=>Promise.reject(e.error)));case"Node.js":let a=require("iconv-lite");this.initGotEnv(t);const{url:n,...r}=t;return await this.got[s](n,r).on("redirect",((e,t)=>{try{if(e.headers["set-cookie"]){const a=e.headers["set-cookie"].map(this.cktough.Cookie.parse).toString();a&&this.ckjar.setCookieSync(a,null),t.cookieJar=this.ckjar}}catch(e){this.logErr(e)}})).then((e=>(e.statusCode=e.status,e.body=a.decode(e.rawBody,this.encoding),e.bodyBytes=e.rawBody,e)),(e=>Promise.reject(e.message)))}}time(e,t=null){const a=t?new Date(t):new Date;let s={"M+":a.getMonth()+1,"d+":a.getDate(),"H+":a.getHours(),"m+":a.getMinutes(),"s+":a.getSeconds(),"q+":Math.floor((a.getMonth()+3)/3),S:a.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(a.getFullYear()+"").substr(4-RegExp.$1.length)));for(let t in s)new RegExp("("+t+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?s[t]:("00"+s[t]).substr((""+s[t]).length)));return e}msg(e=name,t="",a="",s){const n=e=>{switch(typeof e){case void 0:return e;case"string":switch(this.platform()){case"Surge":case"Stash":case"Egern":default:return{url:e};case"Loon":case"Shadowrocket":return e;case"Quantumult X":return{"open-url":e};case"Node.js":return}case"object":switch(this.platform()){case"Surge":case"Stash":case"Egern":case"Shadowrocket":default:return{url:e.url||e.openUrl||e["open-url"]};case"Loon":return{openUrl:e.openUrl||e.url||e["open-url"],mediaUrl:e.mediaUrl||e["media-url"]};case"Quantumult X":return{"open-url":e["open-url"]||e.url||e.openUrl,"media-url":e["media-url"]||e.mediaUrl,"update-pasteboard":e["update-pasteboard"]||e.updatePasteboard};case"Node.js":return}default:return}};if(!this.isMute)switch(this.platform()){case"Surge":case"Loon":case"Stash":case"Egern":case"Shadowrocket":default:$notification.post(e,t,a,n(s));break;case"Quantumult X":$notify(e,t,a,n(s));case"Node.js":}if(!this.isMuteLog){let s=["","==============ðŸ“£ç³»ç»Ÿé€šçŸ¥ðŸ“£=============="];s.push(e),t&&s.push(t),a&&s.push(a),console.log(s.join("\n")),this.logs=this.logs.concat(s)}}log(...e){e.length>0&&(this.logs=[...this.logs,...e]),console.log(e.join(this.logSeparator))}logErr(e){switch(this.platform()){case"Surge":case"Loon":case"Stash":case"Egern":case"Shadowrocket":case"Quantumult X":default:this.log("",`â—ï¸ ${this.name}, é”™è¯¯!`,e);break;case"Node.js":this.log("",`â—ï¸${this.name}, é”™è¯¯!`,e.stack)}}wait(e){return new Promise((t=>setTimeout(t,e)))}done(t={}){const a=((new Date).getTime()-this.startTime)/1e3;switch(this.log("",`ðŸš© ${this.name}, ç»“æŸ! ðŸ•› ${a} ç§’`,""),this.platform()){case"Surge":t.policy&&e.set(t,"headers.X-Surge-Policy",t.policy),$done(t);break;case"Loon":t.policy&&(t.node=t.policy),$done(t);break;case"Stash":t.policy&&e.set(t,"headers.X-Stash-Selected-Proxy",encodeURI(t.policy)),$done(t);break;case"Egern":case"Shadowrocket":default:$done(t);break;case"Quantumult X":t.policy&&e.set(t,"opts.policy",t.policy),delete t["auto-redirect"],delete t["auto-cookie"],delete t["binary-mode"],delete t.charset,delete t.host,delete t.insecure,delete t.method,delete t.opt,delete t.path,delete t.policy,delete t["policy-descriptor"],delete t.scheme,delete t.sessionIndex,delete t.statusCode,delete t.timeout,t.body instanceof ArrayBuffer?(t.bodyBytes=t.body,delete t.body):ArrayBuffer.isView(t.body)?(t.bodyBytes=t.body.buffer.slice(t.body.byteOffset,t.body.byteLength+t.body.byteOffset),delete t.body):t.body&&delete t.bodyBytes,$done(t);break;case"Node.js":process.exit(1)}}}var s={Switch:!0},n={Settings:s},r={Switch:!0,ForceHost:"1",Locales:["CHN","HKG","TWN"],Proxies:{CHN:"DIRECT",HKG:"ðŸ‡­ðŸ‡°é¦™æ¸¯",MAC:"ðŸ‡²ðŸ‡´æ¾³é—¨",TWN:"ðŸ‡¹ðŸ‡¼å°æ¹¾"}},i={Locale:{CHN:"",HKG:"ï¼ˆåƒ…é™æ¸¯.*åœ°å€ï¼‰",MAC:"ï¼ˆåƒ…é™.*æ¾³.*åœ°å€ï¼‰",TWN:"ï¼ˆåƒ…é™.*å°åœ°å€ï¼‰"},SearchNav:{CHN:{name:"ç•ªå‰§ðŸ‡¨ðŸ‡³",total:0,pages:0,type:17},HKG:{name:"åŠ¨ç”»ðŸ‡­ðŸ‡°",total:0,pages:0,type:27},MAC:{name:"åŠ¨ç”»ðŸ‡²ðŸ‡´",total:0,pages:0,type:37},TWN:{name:"åŠ¨ç”»ðŸ‡¹ðŸ‡¼",total:0,pages:0,type:47}}},o={Settings:r,Configs:i},l=Database={Default:Object.freeze({__proto__:null,Settings:s,default:n}),Global:Object.freeze({__proto__:null,Configs:i,Settings:r,default:o})};function c(a,s,n){console.log("â˜‘ï¸ Set Environment Variables","");let{Settings:r,Caches:i,Configs:o}=function(a,s,n){let r=t.getItem(a,n),i={};if("undefined"!=typeof $argument&&Boolean($argument)){let t=Object.fromEntries($argument.split("&").map((e=>e.split("=").map((e=>e.replace(/\"/g,""))))));for(let a in t)e.set(i,a,t[a])}const o={Settings:n?.Default?.Settings||{},Configs:n?.Default?.Configs||{},Caches:{}};Array.isArray(s)||(s=[s]);for(let e of s)o.Settings={...o.Settings,...n?.[e]?.Settings,...i,...r?.[e]?.Settings},o.Configs={...o.Configs,...n?.[e]?.Configs},r?.[e]?.Caches&&"string"==typeof r?.[e]?.Caches&&(r[e].Caches=JSON.parse(r?.[e]?.Caches)),o.Caches={...o.Caches,...r?.[e]?.Caches};return function e(t,a){for(var s in t){var n=t[s];t[s]="object"==typeof n&&null!==n?e(n,a):a(s,n)}return t}(o.Settings,((e,t)=>("true"===t||"false"===t?t=JSON.parse(t):"string"==typeof t&&(t=t.includes(",")?t.split(",").map((e=>l(e))):l(t)),t))),o;function l(e){return e&&!isNaN(e)&&(e=parseInt(e,10)),e}}(a,s,n);return Array.isArray(r?.Locales)||(r.Locales=r.Locales?[r.Locales]:[]),console.log(`âœ… Set Environment Variables, Settings: ${typeof r}, Settingså†…å®¹: ${JSON.stringify(r)}`,""),Array.isArray(i?.ss)||(i.ss=[]),Array.isArray(i?.ep)||(i.ep=[]),i.ss=new Map(i?.ss??[]),i.ep=new Map(i?.ep??[]),{Settings:r,Caches:i,Configs:o}}
/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */function h(e){let t=e.length;for(;--t>=0;)e[t]=0}const d=256,u=286,f=30,p=15,g=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),m=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),b=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),w=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),_=new Array(576);h(_);const y=new Array(60);h(y);const k=new Array(512);h(k);const v=new Array(256);h(v);const N=new Array(29);h(N);const T=new Array(f);function I(e,t,a,s,n){this.static_tree=e,this.extra_bits=t,this.extra_base=a,this.elems=s,this.max_length=n,this.has_stree=e&&e.length}let S,x,E;function A(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}h(T);const O=e=>e<256?k[e]:k[256+(e>>>7)],B=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},U=(e,t,a)=>{e.bi_valid>16-a?(e.bi_buf|=t<<e.bi_valid&65535,B(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=a-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=a)},R=(e,t,a)=>{U(e,a[2*t],a[2*t+1])},L=(e,t)=>{let a=0;do{a|=1&e,e>>>=1,a<<=1}while(--t>0);return a>>>1},C=(e,t,a)=>{const s=new Array(16);let n,r,i=0;for(n=1;n<=p;n++)i=i+a[n-1]<<1,s[n]=i;for(r=0;r<=t;r++){let t=e[2*r+1];0!==t&&(e[2*r]=L(s[t]++,t))}},D=e=>{let t;for(t=0;t<u;t++)e.dyn_ltree[2*t]=0;for(t=0;t<f;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},$=e=>{e.bi_valid>8?B(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},z=(e,t,a,s)=>{const n=2*t,r=2*a;return e[n]<e[r]||e[n]===e[r]&&s[t]<=s[a]},F=(e,t,a)=>{const s=e.heap[a];let n=a<<1;for(;n<=e.heap_len&&(n<e.heap_len&&z(t,e.heap[n+1],e.heap[n],e.depth)&&n++,!z(t,s,e.heap[n],e.depth));)e.heap[a]=e.heap[n],a=n,n<<=1;e.heap[a]=s},V=(e,t,a)=>{let s,n,r,i,o=0;if(0!==e.sym_next)do{s=255&e.pending_buf[e.sym_buf+o++],s+=(255&e.pending_buf[e.sym_buf+o++])<<8,n=e.pending_buf[e.sym_buf+o++],0===s?R(e,n,t):(r=v[n],R(e,r+d+1,t),i=g[r],0!==i&&(n-=N[r],U(e,n,i)),s--,r=O(s),R(e,r,a),i=m[r],0!==i&&(s-=T[r],U(e,s,i)))}while(o<e.sym_next);R(e,256,t)},j=(e,t)=>{const a=t.dyn_tree,s=t.stat_desc.static_tree,n=t.stat_desc.has_stree,r=t.stat_desc.elems;let i,o,l,c=-1;for(e.heap_len=0,e.heap_max=573,i=0;i<r;i++)0!==a[2*i]?(e.heap[++e.heap_len]=c=i,e.depth[i]=0):a[2*i+1]=0;for(;e.heap_len<2;)l=e.heap[++e.heap_len]=c<2?++c:0,a[2*l]=1,e.depth[l]=0,e.opt_len--,n&&(e.static_len-=s[2*l+1]);for(t.max_code=c,i=e.heap_len>>1;i>=1;i--)F(e,a,i);l=r;do{i=e.heap[1],e.heap[1]=e.heap[e.heap_len--],F(e,a,1),o=e.heap[1],e.heap[--e.heap_max]=i,e.heap[--e.heap_max]=o,a[2*l]=a[2*i]+a[2*o],e.depth[l]=(e.depth[i]>=e.depth[o]?e.depth[i]:e.depth[o])+1,a[2*i+1]=a[2*o+1]=l,e.heap[1]=l++,F(e,a,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],((e,t)=>{const a=t.dyn_tree,s=t.max_code,n=t.stat_desc.static_tree,r=t.stat_desc.has_stree,i=t.stat_desc.extra_bits,o=t.stat_desc.extra_base,l=t.stat_desc.max_length;let c,h,d,u,f,g,m=0;for(u=0;u<=p;u++)e.bl_count[u]=0;for(a[2*e.heap[e.heap_max]+1]=0,c=e.heap_max+1;c<573;c++)h=e.heap[c],u=a[2*a[2*h+1]+1]+1,u>l&&(u=l,m++),a[2*h+1]=u,h>s||(e.bl_count[u]++,f=0,h>=o&&(f=i[h-o]),g=a[2*h],e.opt_len+=g*(u+f),r&&(e.static_len+=g*(n[2*h+1]+f)));if(0!==m){do{for(u=l-1;0===e.bl_count[u];)u--;e.bl_count[u]--,e.bl_count[u+1]+=2,e.bl_count[l]--,m-=2}while(m>0);for(u=l;0!==u;u--)for(h=e.bl_count[u];0!==h;)d=e.heap[--c],d>s||(a[2*d+1]!==u&&(e.opt_len+=(u-a[2*d+1])*a[2*d],a[2*d+1]=u),h--)}})(e,t),C(a,c,e.bl_count)},P=(e,t,a)=>{let s,n,r=-1,i=t[1],o=0,l=7,c=4;for(0===i&&(l=138,c=3),t[2*(a+1)+1]=65535,s=0;s<=a;s++)n=i,i=t[2*(s+1)+1],++o<l&&n===i||(o<c?e.bl_tree[2*n]+=o:0!==n?(n!==r&&e.bl_tree[2*n]++,e.bl_tree[32]++):o<=10?e.bl_tree[34]++:e.bl_tree[36]++,o=0,r=n,0===i?(l=138,c=3):n===i?(l=6,c=3):(l=7,c=4))},Z=(e,t,a)=>{let s,n,r=-1,i=t[1],o=0,l=7,c=4;for(0===i&&(l=138,c=3),s=0;s<=a;s++)if(n=i,i=t[2*(s+1)+1],!(++o<l&&n===i)){if(o<c)do{R(e,n,e.bl_tree)}while(0!=--o);else 0!==n?(n!==r&&(R(e,n,e.bl_tree),o--),R(e,16,e.bl_tree),U(e,o-3,2)):o<=10?(R(e,17,e.bl_tree),U(e,o-3,3)):(R(e,18,e.bl_tree),U(e,o-11,7));o=0,r=n,0===i?(l=138,c=3):n===i?(l=6,c=3):(l=7,c=4)}};let M=!1;const H=(e,t,a,s)=>{U(e,0+(s?1:0),3),$(e),B(e,a),B(e,~a),a&&e.pending_buf.set(e.window.subarray(t,t+a),e.pending),e.pending+=a};var K=(e,t,a,s)=>{let n,r,i=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=(e=>{let t,a=4093624447;for(t=0;t<=31;t++,a>>>=1)if(1&a&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<d;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0})(e)),j(e,e.l_desc),j(e,e.d_desc),i=(e=>{let t;for(P(e,e.dyn_ltree,e.l_desc.max_code),P(e,e.dyn_dtree,e.d_desc.max_code),j(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*w[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t})(e),n=e.opt_len+3+7>>>3,r=e.static_len+3+7>>>3,r<=n&&(n=r)):n=r=a+5,a+4<=n&&-1!==t?H(e,t,a,s):4===e.strategy||r===n?(U(e,2+(s?1:0),3),V(e,_,y)):(U(e,4+(s?1:0),3),((e,t,a,s)=>{let n;for(U(e,t-257,5),U(e,a-1,5),U(e,s-4,4),n=0;n<s;n++)U(e,e.bl_tree[2*w[n]+1],3);Z(e,e.dyn_ltree,t-1),Z(e,e.dyn_dtree,a-1)})(e,e.l_desc.max_code+1,e.d_desc.max_code+1,i+1),V(e,e.dyn_ltree,e.dyn_dtree)),D(e),s&&$(e)},X={_tr_init:e=>{M||((()=>{let e,t,a,s,n;const r=new Array(16);for(a=0,s=0;s<28;s++)for(N[s]=a,e=0;e<1<<g[s];e++)v[a++]=s;for(v[a-1]=s,n=0,s=0;s<16;s++)for(T[s]=n,e=0;e<1<<m[s];e++)k[n++]=s;for(n>>=7;s<f;s++)for(T[s]=n<<7,e=0;e<1<<m[s]-7;e++)k[256+n++]=s;for(t=0;t<=p;t++)r[t]=0;for(e=0;e<=143;)_[2*e+1]=8,e++,r[8]++;for(;e<=255;)_[2*e+1]=9,e++,r[9]++;for(;e<=279;)_[2*e+1]=7,e++,r[7]++;for(;e<=287;)_[2*e+1]=8,e++,r[8]++;for(C(_,287,r),e=0;e<f;e++)y[2*e+1]=5,y[2*e]=L(e,5);S=new I(_,g,257,u,p),x=new I(y,m,0,f,p),E=new I(new Array(0),b,0,19,7)})(),M=!0),e.l_desc=new A(e.dyn_ltree,S),e.d_desc=new A(e.dyn_dtree,x),e.bl_desc=new A(e.bl_tree,E),e.bi_buf=0,e.bi_valid=0,D(e)},_tr_stored_block:H,_tr_flush_block:K,_tr_tally:(e,t,a)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=a,0===t?e.dyn_ltree[2*a]++:(e.matches++,t--,e.dyn_ltree[2*(v[a]+d+1)]++,e.dyn_dtree[2*O(t)]++),e.sym_next===e.sym_end),_tr_align:e=>{U(e,2,3),R(e,256,_),(e=>{16===e.bi_valid?(B(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)})(e)}};var G=(e,t,a,s)=>{let n=65535&e|0,r=e>>>16&65535|0,i=0;for(;0!==a;){i=a>2e3?2e3:a,a-=i;do{n=n+t[s++]|0,r=r+n|0}while(--i);n%=65521,r%=65521}return n|r<<16|0};const q=new Uint32Array((()=>{let e,t=[];for(var a=0;a<256;a++){e=a;for(var s=0;s<8;s++)e=1&e?3988292384^e>>>1:e>>>1;t[a]=e}return t})());var W=(e,t,a,s)=>{const n=q,r=s+a;e^=-1;for(let a=s;a<r;a++)e=e>>>8^n[255&(e^t[a])];return-1^e},J={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Y={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:Q,_tr_stored_block:ee,_tr_flush_block:te,_tr_tally:ae,_tr_align:se}=X,{Z_NO_FLUSH:ne,Z_PARTIAL_FLUSH:re,Z_FULL_FLUSH:ie,Z_FINISH:oe,Z_BLOCK:le,Z_OK:ce,Z_STREAM_END:he,Z_STREAM_ERROR:de,Z_DATA_ERROR:ue,Z_BUF_ERROR:fe,Z_DEFAULT_COMPRESSION:pe,Z_FILTERED:ge,Z_HUFFMAN_ONLY:me,Z_RLE:be,Z_FIXED:we,Z_DEFAULT_STRATEGY:_e,Z_UNKNOWN:ye,Z_DEFLATED:ke}=Y,ve=258,Ne=262,Te=42,Ie=113,Se=666,xe=(e,t)=>(e.msg=J[t],t),Ee=e=>2*e-(e>4?9:0),Ae=e=>{let t=e.length;for(;--t>=0;)e[t]=0},Oe=e=>{let t,a,s,n=e.w_size;t=e.hash_size,s=t;do{a=e.head[--s],e.head[s]=a>=n?a-n:0}while(--t);t=n,s=t;do{a=e.prev[--s],e.prev[s]=a>=n?a-n:0}while(--t)};let Be=(e,t,a)=>(t<<e.hash_shift^a)&e.hash_mask;const Ue=e=>{const t=e.state;let a=t.pending;a>e.avail_out&&(a=e.avail_out),0!==a&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+a),e.next_out),e.next_out+=a,t.pending_out+=a,e.total_out+=a,e.avail_out-=a,t.pending-=a,0===t.pending&&(t.pending_out=0))},Re=(e,t)=>{te(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,Ue(e.strm)},Le=(e,t)=>{e.pending_buf[e.pending++]=t},Ce=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},De=(e,t,a,s)=>{let n=e.avail_in;return n>s&&(n=s),0===n?0:(e.avail_in-=n,t.set(e.input.subarray(e.next_in,e.next_in+n),a),1===e.state.wrap?e.adler=G(e.adler,t,n,a):2===e.state.wrap&&(e.adler=W(e.adler,t,n,a)),e.next_in+=n,e.total_in+=n,n)},$e=(e,t)=>{let a,s,n=e.max_chain_length,r=e.strstart,i=e.prev_length,o=e.nice_match;const l=e.strstart>e.w_size-Ne?e.strstart-(e.w_size-Ne):0,c=e.window,h=e.w_mask,d=e.prev,u=e.strstart+ve;let f=c[r+i-1],p=c[r+i];e.prev_length>=e.good_match&&(n>>=2),o>e.lookahead&&(o=e.lookahead);do{if(a=t,c[a+i]===p&&c[a+i-1]===f&&c[a]===c[r]&&c[++a]===c[r+1]){r+=2,a++;do{}while(c[++r]===c[++a]&&c[++r]===c[++a]&&c[++r]===c[++a]&&c[++r]===c[++a]&&c[++r]===c[++a]&&c[++r]===c[++a]&&c[++r]===c[++a]&&c[++r]===c[++a]&&r<u);if(s=ve-(u-r),r=u-ve,s>i){if(e.match_start=t,i=s,s>=o)break;f=c[r+i-1],p=c[r+i]}}}while((t=d[t&h])>l&&0!=--n);return i<=e.lookahead?i:e.lookahead},ze=e=>{const t=e.w_size;let a,s,n;do{if(s=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-Ne)&&(e.window.set(e.window.subarray(t,t+t-s),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),Oe(e),s+=t),0===e.strm.avail_in)break;if(a=De(e.strm,e.window,e.strstart+e.lookahead,s),e.lookahead+=a,e.lookahead+e.insert>=3)for(n=e.strstart-e.insert,e.ins_h=e.window[n],e.ins_h=Be(e,e.ins_h,e.window[n+1]);e.insert&&(e.ins_h=Be(e,e.ins_h,e.window[n+3-1]),e.prev[n&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=n,n++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<Ne&&0!==e.strm.avail_in)},Fe=(e,t)=>{let a,s,n,r=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,i=0,o=e.strm.avail_in;do{if(a=65535,n=e.bi_valid+42>>3,e.strm.avail_out<n)break;if(n=e.strm.avail_out-n,s=e.strstart-e.block_start,a>s+e.strm.avail_in&&(a=s+e.strm.avail_in),a>n&&(a=n),a<r&&(0===a&&t!==oe||t===ne||a!==s+e.strm.avail_in))break;i=t===oe&&a===s+e.strm.avail_in?1:0,ee(e,0,0,i),e.pending_buf[e.pending-4]=a,e.pending_buf[e.pending-3]=a>>8,e.pending_buf[e.pending-2]=~a,e.pending_buf[e.pending-1]=~a>>8,Ue(e.strm),s&&(s>a&&(s=a),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+s),e.strm.next_out),e.strm.next_out+=s,e.strm.avail_out-=s,e.strm.total_out+=s,e.block_start+=s,a-=s),a&&(De(e.strm,e.strm.output,e.strm.next_out,a),e.strm.next_out+=a,e.strm.avail_out-=a,e.strm.total_out+=a)}while(0===i);return o-=e.strm.avail_in,o&&(o>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=o&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-o,e.strm.next_in),e.strstart),e.strstart+=o,e.insert+=o>e.w_size-e.insert?e.w_size-e.insert:o),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),i?4:t!==ne&&t!==oe&&0===e.strm.avail_in&&e.strstart===e.block_start?2:(n=e.window_size-e.strstart,e.strm.avail_in>n&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,n+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),n>e.strm.avail_in&&(n=e.strm.avail_in),n&&(De(e.strm,e.window,e.strstart,n),e.strstart+=n,e.insert+=n>e.w_size-e.insert?e.w_size-e.insert:n),e.high_water<e.strstart&&(e.high_water=e.strstart),n=e.bi_valid+42>>3,n=e.pending_buf_size-n>65535?65535:e.pending_buf_size-n,r=n>e.w_size?e.w_size:n,s=e.strstart-e.block_start,(s>=r||(s||t===oe)&&t!==ne&&0===e.strm.avail_in&&s<=n)&&(a=s>n?n:s,i=t===oe&&0===e.strm.avail_in&&a===s?1:0,ee(e,e.block_start,a,i),e.block_start+=a,Ue(e.strm)),i?3:1)},Ve=(e,t)=>{let a,s;for(;;){if(e.lookahead<Ne){if(ze(e),e.lookahead<Ne&&t===ne)return 1;if(0===e.lookahead)break}if(a=0,e.lookahead>=3&&(e.ins_h=Be(e,e.ins_h,e.window[e.strstart+3-1]),a=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==a&&e.strstart-a<=e.w_size-Ne&&(e.match_length=$e(e,a)),e.match_length>=3)if(s=ae(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=Be(e,e.ins_h,e.window[e.strstart+3-1]),a=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=Be(e,e.ins_h,e.window[e.strstart+1]);else s=ae(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(s&&(Re(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,t===oe?(Re(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Re(e,!1),0===e.strm.avail_out)?1:2},je=(e,t)=>{let a,s,n;for(;;){if(e.lookahead<Ne){if(ze(e),e.lookahead<Ne&&t===ne)return 1;if(0===e.lookahead)break}if(a=0,e.lookahead>=3&&(e.ins_h=Be(e,e.ins_h,e.window[e.strstart+3-1]),a=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==a&&e.prev_length<e.max_lazy_match&&e.strstart-a<=e.w_size-Ne&&(e.match_length=$e(e,a),e.match_length<=5&&(e.strategy===ge||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){n=e.strstart+e.lookahead-3,s=ae(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=n&&(e.ins_h=Be(e,e.ins_h,e.window[e.strstart+3-1]),a=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,s&&(Re(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if(s=ae(e,0,e.window[e.strstart-1]),s&&Re(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(s=ae(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===oe?(Re(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Re(e,!1),0===e.strm.avail_out)?1:2};function Pe(e,t,a,s,n){this.good_length=e,this.max_lazy=t,this.nice_length=a,this.max_chain=s,this.func=n}const Ze=[new Pe(0,0,0,0,Fe),new Pe(4,4,8,4,Ve),new Pe(4,5,16,8,Ve),new Pe(4,6,32,32,Ve),new Pe(4,4,16,16,je),new Pe(8,16,32,32,je),new Pe(8,16,128,128,je),new Pe(8,32,128,256,je),new Pe(32,128,258,1024,je),new Pe(32,258,258,4096,je)];function Me(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=ke,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),Ae(this.dyn_ltree),Ae(this.dyn_dtree),Ae(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),Ae(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),Ae(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const He=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==Te&&57!==t.status&&69!==t.status&&73!==t.status&&91!==t.status&&103!==t.status&&t.status!==Ie&&t.status!==Se?1:0},Ke=e=>{if(He(e))return xe(e,de);e.total_in=e.total_out=0,e.data_type=ye;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=2===t.wrap?57:t.wrap?Te:Ie,e.adler=2===t.wrap?0:1,t.last_flush=-2,Q(t),ce},Xe=e=>{const t=Ke(e);var a;return t===ce&&((a=e.state).window_size=2*a.w_size,Ae(a.head),a.max_lazy_match=Ze[a.level].max_lazy,a.good_match=Ze[a.level].good_length,a.nice_match=Ze[a.level].nice_length,a.max_chain_length=Ze[a.level].max_chain,a.strstart=0,a.block_start=0,a.lookahead=0,a.insert=0,a.match_length=a.prev_length=2,a.match_available=0,a.ins_h=0),t},Ge=(e,t,a,s,n,r)=>{if(!e)return de;let i=1;if(t===pe&&(t=6),s<0?(i=0,s=-s):s>15&&(i=2,s-=16),n<1||n>9||a!==ke||s<8||s>15||t<0||t>9||r<0||r>we||8===s&&1!==i)return xe(e,de);8===s&&(s=9);const o=new Me;return e.state=o,o.strm=e,o.status=Te,o.wrap=i,o.gzhead=null,o.w_bits=s,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=n+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+3-1)/3),o.window=new Uint8Array(2*o.w_size),o.head=new Uint16Array(o.hash_size),o.prev=new Uint16Array(o.w_size),o.lit_bufsize=1<<n+6,o.pending_buf_size=4*o.lit_bufsize,o.pending_buf=new Uint8Array(o.pending_buf_size),o.sym_buf=o.lit_bufsize,o.sym_end=3*(o.lit_bufsize-1),o.level=t,o.strategy=r,o.method=a,Xe(e)};var qe={deflateInit:(e,t)=>Ge(e,t,ke,15,8,_e),deflateInit2:Ge,deflateReset:Xe,deflateResetKeep:Ke,deflateSetHeader:(e,t)=>He(e)||2!==e.state.wrap?de:(e.state.gzhead=t,ce),deflate:(e,t)=>{if(He(e)||t>le||t<0)return e?xe(e,de):de;const a=e.state;if(!e.output||0!==e.avail_in&&!e.input||a.status===Se&&t!==oe)return xe(e,0===e.avail_out?fe:de);const s=a.last_flush;if(a.last_flush=t,0!==a.pending){if(Ue(e),0===e.avail_out)return a.last_flush=-1,ce}else if(0===e.avail_in&&Ee(t)<=Ee(s)&&t!==oe)return xe(e,fe);if(a.status===Se&&0!==e.avail_in)return xe(e,fe);if(a.status===Te&&0===a.wrap&&(a.status=Ie),a.status===Te){let t=ke+(a.w_bits-8<<4)<<8,s=-1;if(s=a.strategy>=me||a.level<2?0:a.level<6?1:6===a.level?2:3,t|=s<<6,0!==a.strstart&&(t|=32),t+=31-t%31,Ce(a,t),0!==a.strstart&&(Ce(a,e.adler>>>16),Ce(a,65535&e.adler)),e.adler=1,a.status=Ie,Ue(e),0!==a.pending)return a.last_flush=-1,ce}if(57===a.status)if(e.adler=0,Le(a,31),Le(a,139),Le(a,8),a.gzhead)Le(a,(a.gzhead.text?1:0)+(a.gzhead.hcrc?2:0)+(a.gzhead.extra?4:0)+(a.gzhead.name?8:0)+(a.gzhead.comment?16:0)),Le(a,255&a.gzhead.time),Le(a,a.gzhead.time>>8&255),Le(a,a.gzhead.time>>16&255),Le(a,a.gzhead.time>>24&255),Le(a,9===a.level?2:a.strategy>=me||a.level<2?4:0),Le(a,255&a.gzhead.os),a.gzhead.extra&&a.gzhead.extra.length&&(Le(a,255&a.gzhead.extra.length),Le(a,a.gzhead.extra.length>>8&255)),a.gzhead.hcrc&&(e.adler=W(e.adler,a.pending_buf,a.pending,0)),a.gzindex=0,a.status=69;else if(Le(a,0),Le(a,0),Le(a,0),Le(a,0),Le(a,0),Le(a,9===a.level?2:a.strategy>=me||a.level<2?4:0),Le(a,3),a.status=Ie,Ue(e),0!==a.pending)return a.last_flush=-1,ce;if(69===a.status){if(a.gzhead.extra){let t=a.pending,s=(65535&a.gzhead.extra.length)-a.gzindex;for(;a.pending+s>a.pending_buf_size;){let n=a.pending_buf_size-a.pending;if(a.pending_buf.set(a.gzhead.extra.subarray(a.gzindex,a.gzindex+n),a.pending),a.pending=a.pending_buf_size,a.gzhead.hcrc&&a.pending>t&&(e.adler=W(e.adler,a.pending_buf,a.pending-t,t)),a.gzindex+=n,Ue(e),0!==a.pending)return a.last_flush=-1,ce;t=0,s-=n}let n=new Uint8Array(a.gzhead.extra);a.pending_buf.set(n.subarray(a.gzindex,a.gzindex+s),a.pending),a.pending+=s,a.gzhead.hcrc&&a.pending>t&&(e.adler=W(e.adler,a.pending_buf,a.pending-t,t)),a.gzindex=0}a.status=73}if(73===a.status){if(a.gzhead.name){let t,s=a.pending;do{if(a.pending===a.pending_buf_size){if(a.gzhead.hcrc&&a.pending>s&&(e.adler=W(e.adler,a.pending_buf,a.pending-s,s)),Ue(e),0!==a.pending)return a.last_flush=-1,ce;s=0}t=a.gzindex<a.gzhead.name.length?255&a.gzhead.name.charCodeAt(a.gzindex++):0,Le(a,t)}while(0!==t);a.gzhead.hcrc&&a.pending>s&&(e.adler=W(e.adler,a.pending_buf,a.pending-s,s)),a.gzindex=0}a.status=91}if(91===a.status){if(a.gzhead.comment){let t,s=a.pending;do{if(a.pending===a.pending_buf_size){if(a.gzhead.hcrc&&a.pending>s&&(e.adler=W(e.adler,a.pending_buf,a.pending-s,s)),Ue(e),0!==a.pending)return a.last_flush=-1,ce;s=0}t=a.gzindex<a.gzhead.comment.length?255&a.gzhead.comment.charCodeAt(a.gzindex++):0,Le(a,t)}while(0!==t);a.gzhead.hcrc&&a.pending>s&&(e.adler=W(e.adler,a.pending_buf,a.pending-s,s))}a.status=103}if(103===a.status){if(a.gzhead.hcrc){if(a.pending+2>a.pending_buf_size&&(Ue(e),0!==a.pending))return a.last_flush=-1,ce;Le(a,255&e.adler),Le(a,e.adler>>8&255),e.adler=0}if(a.status=Ie,Ue(e),0!==a.pending)return a.last_flush=-1,ce}if(0!==e.avail_in||0!==a.lookahead||t!==ne&&a.status!==Se){let s=0===a.level?Fe(a,t):a.strategy===me?((e,t)=>{let a;for(;;){if(0===e.lookahead&&(ze(e),0===e.lookahead)){if(t===ne)return 1;break}if(e.match_length=0,a=ae(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,a&&(Re(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===oe?(Re(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Re(e,!1),0===e.strm.avail_out)?1:2})(a,t):a.strategy===be?((e,t)=>{let a,s,n,r;const i=e.window;for(;;){if(e.lookahead<=ve){if(ze(e),e.lookahead<=ve&&t===ne)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(n=e.strstart-1,s=i[n],s===i[++n]&&s===i[++n]&&s===i[++n])){r=e.strstart+ve;do{}while(s===i[++n]&&s===i[++n]&&s===i[++n]&&s===i[++n]&&s===i[++n]&&s===i[++n]&&s===i[++n]&&s===i[++n]&&n<r);e.match_length=ve-(r-n),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(a=ae(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(a=ae(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),a&&(Re(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===oe?(Re(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Re(e,!1),0===e.strm.avail_out)?1:2})(a,t):Ze[a.level].func(a,t);if(3!==s&&4!==s||(a.status=Se),1===s||3===s)return 0===e.avail_out&&(a.last_flush=-1),ce;if(2===s&&(t===re?se(a):t!==le&&(ee(a,0,0,!1),t===ie&&(Ae(a.head),0===a.lookahead&&(a.strstart=0,a.block_start=0,a.insert=0))),Ue(e),0===e.avail_out))return a.last_flush=-1,ce}return t!==oe?ce:a.wrap<=0?he:(2===a.wrap?(Le(a,255&e.adler),Le(a,e.adler>>8&255),Le(a,e.adler>>16&255),Le(a,e.adler>>24&255),Le(a,255&e.total_in),Le(a,e.total_in>>8&255),Le(a,e.total_in>>16&255),Le(a,e.total_in>>24&255)):(Ce(a,e.adler>>>16),Ce(a,65535&e.adler)),Ue(e),a.wrap>0&&(a.wrap=-a.wrap),0!==a.pending?ce:he)},deflateEnd:e=>{if(He(e))return de;const t=e.state.status;return e.state=null,t===Ie?xe(e,ue):ce},deflateSetDictionary:(e,t)=>{let a=t.length;if(He(e))return de;const s=e.state,n=s.wrap;if(2===n||1===n&&s.status!==Te||s.lookahead)return de;if(1===n&&(e.adler=G(e.adler,t,a,0)),s.wrap=0,a>=s.w_size){0===n&&(Ae(s.head),s.strstart=0,s.block_start=0,s.insert=0);let e=new Uint8Array(s.w_size);e.set(t.subarray(a-s.w_size,a),0),t=e,a=s.w_size}const r=e.avail_in,i=e.next_in,o=e.input;for(e.avail_in=a,e.next_in=0,e.input=t,ze(s);s.lookahead>=3;){let e=s.strstart,t=s.lookahead-2;do{s.ins_h=Be(s,s.ins_h,s.window[e+3-1]),s.prev[e&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=e,e++}while(--t);s.strstart=e,s.lookahead=2,ze(s)}return s.strstart+=s.lookahead,s.block_start=s.strstart,s.insert=s.lookahead,s.lookahead=0,s.match_length=s.prev_length=2,s.match_available=0,e.next_in=i,e.input=o,e.avail_in=r,s.wrap=n,ce},deflateInfo:"pako deflate (from Nodeca project)"};const We=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var Je={assign:function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const a=t.shift();if(a){if("object"!=typeof a)throw new TypeError(a+"must be non-object");for(const t in a)We(a,t)&&(e[t]=a[t])}}return e},flattenChunks:e=>{let t=0;for(let a=0,s=e.length;a<s;a++)t+=e[a].length;const a=new Uint8Array(t);for(let t=0,s=0,n=e.length;t<n;t++){let n=e[t];a.set(n,s),s+=n.length}return a}};let Ye=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){Ye=!1}const Qe=new Uint8Array(256);for(let e=0;e<256;e++)Qe[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;Qe[254]=Qe[254]=1;var et={string2buf:e=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);let t,a,s,n,r,i=e.length,o=0;for(n=0;n<i;n++)a=e.charCodeAt(n),55296==(64512&a)&&n+1<i&&(s=e.charCodeAt(n+1),56320==(64512&s)&&(a=65536+(a-55296<<10)+(s-56320),n++)),o+=a<128?1:a<2048?2:a<65536?3:4;for(t=new Uint8Array(o),r=0,n=0;r<o;n++)a=e.charCodeAt(n),55296==(64512&a)&&n+1<i&&(s=e.charCodeAt(n+1),56320==(64512&s)&&(a=65536+(a-55296<<10)+(s-56320),n++)),a<128?t[r++]=a:a<2048?(t[r++]=192|a>>>6,t[r++]=128|63&a):a<65536?(t[r++]=224|a>>>12,t[r++]=128|a>>>6&63,t[r++]=128|63&a):(t[r++]=240|a>>>18,t[r++]=128|a>>>12&63,t[r++]=128|a>>>6&63,t[r++]=128|63&a);return t},buf2string:(e,t)=>{const a=t||e.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,t));let s,n;const r=new Array(2*a);for(n=0,s=0;s<a;){let t=e[s++];if(t<128){r[n++]=t;continue}let i=Qe[t];if(i>4)r[n++]=65533,s+=i-1;else{for(t&=2===i?31:3===i?15:7;i>1&&s<a;)t=t<<6|63&e[s++],i--;i>1?r[n++]=65533:t<65536?r[n++]=t:(t-=65536,r[n++]=55296|t>>10&1023,r[n++]=56320|1023&t)}}return((e,t)=>{if(t<65534&&e.subarray&&Ye)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let a="";for(let s=0;s<t;s++)a+=String.fromCharCode(e[s]);return a})(r,n)},utf8border:(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let a=t-1;for(;a>=0&&128==(192&e[a]);)a--;return a<0||0===a?t:a+Qe[e[a]]>t?a:t}};var tt=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const at=Object.prototype.toString,{Z_NO_FLUSH:st,Z_SYNC_FLUSH:nt,Z_FULL_FLUSH:rt,Z_FINISH:it,Z_OK:ot,Z_STREAM_END:lt,Z_DEFAULT_COMPRESSION:ct,Z_DEFAULT_STRATEGY:ht,Z_DEFLATED:dt}=Y;function ut(e){this.options=Je.assign({level:ct,method:dt,chunkSize:16384,windowBits:15,memLevel:8,strategy:ht},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new tt,this.strm.avail_out=0;let a=qe.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(a!==ot)throw new Error(J[a]);if(t.header&&qe.deflateSetHeader(this.strm,t.header),t.dictionary){let e;if(e="string"==typeof t.dictionary?et.string2buf(t.dictionary):"[object ArrayBuffer]"===at.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,a=qe.deflateSetDictionary(this.strm,e),a!==ot)throw new Error(J[a]);this._dict_set=!0}}function ft(e,t){const a=new ut(t);if(a.push(e,!0),a.err)throw a.msg||J[a.err];return a.result}ut.prototype.push=function(e,t){const a=this.strm,s=this.options.chunkSize;let n,r;if(this.ended)return!1;for(r=t===~~t?t:!0===t?it:st,"string"==typeof e?a.input=et.string2buf(e):"[object ArrayBuffer]"===at.call(e)?a.input=new Uint8Array(e):a.input=e,a.next_in=0,a.avail_in=a.input.length;;)if(0===a.avail_out&&(a.output=new Uint8Array(s),a.next_out=0,a.avail_out=s),(r===nt||r===rt)&&a.avail_out<=6)this.onData(a.output.subarray(0,a.next_out)),a.avail_out=0;else{if(n=qe.deflate(a,r),n===lt)return a.next_out>0&&this.onData(a.output.subarray(0,a.next_out)),n=qe.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===ot;if(0!==a.avail_out){if(r>0&&a.next_out>0)this.onData(a.output.subarray(0,a.next_out)),a.avail_out=0;else if(0===a.avail_in)break}else this.onData(a.output)}return!0},ut.prototype.onData=function(e){this.chunks.push(e)},ut.prototype.onEnd=function(e){e===ot&&(this.result=Je.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var pt={Deflate:ut,deflate:ft,deflateRaw:function(e,t){return(t=t||{}).raw=!0,ft(e,t)},gzip:function(e,t){return(t=t||{}).gzip=!0,ft(e,t)},constants:Y};const gt=16209;var mt=function(e,t){let a,s,n,r,i,o,l,c,h,d,u,f,p,g,m,b,w,_,y,k,v,N,T,I;const S=e.state;a=e.next_in,T=e.input,s=a+(e.avail_in-5),n=e.next_out,I=e.output,r=n-(t-e.avail_out),i=n+(e.avail_out-257),o=S.dmax,l=S.wsize,c=S.whave,h=S.wnext,d=S.window,u=S.hold,f=S.bits,p=S.lencode,g=S.distcode,m=(1<<S.lenbits)-1,b=(1<<S.distbits)-1;e:do{f<15&&(u+=T[a++]<<f,f+=8,u+=T[a++]<<f,f+=8),w=p[u&m];t:for(;;){if(_=w>>>24,u>>>=_,f-=_,_=w>>>16&255,0===_)I[n++]=65535&w;else{if(!(16&_)){if(0==(64&_)){w=p[(65535&w)+(u&(1<<_)-1)];continue t}if(32&_){S.mode=16191;break e}e.msg="invalid literal/length code",S.mode=gt;break e}y=65535&w,_&=15,_&&(f<_&&(u+=T[a++]<<f,f+=8),y+=u&(1<<_)-1,u>>>=_,f-=_),f<15&&(u+=T[a++]<<f,f+=8,u+=T[a++]<<f,f+=8),w=g[u&b];a:for(;;){if(_=w>>>24,u>>>=_,f-=_,_=w>>>16&255,!(16&_)){if(0==(64&_)){w=g[(65535&w)+(u&(1<<_)-1)];continue a}e.msg="invalid distance code",S.mode=gt;break e}if(k=65535&w,_&=15,f<_&&(u+=T[a++]<<f,f+=8,f<_&&(u+=T[a++]<<f,f+=8)),k+=u&(1<<_)-1,k>o){e.msg="invalid distance too far back",S.mode=gt;break e}if(u>>>=_,f-=_,_=n-r,k>_){if(_=k-_,_>c&&S.sane){e.msg="invalid distance too far back",S.mode=gt;break e}if(v=0,N=d,0===h){if(v+=l-_,_<y){y-=_;do{I[n++]=d[v++]}while(--_);v=n-k,N=I}}else if(h<_){if(v+=l+h-_,_-=h,_<y){y-=_;do{I[n++]=d[v++]}while(--_);if(v=0,h<y){_=h,y-=_;do{I[n++]=d[v++]}while(--_);v=n-k,N=I}}}else if(v+=h-_,_<y){y-=_;do{I[n++]=d[v++]}while(--_);v=n-k,N=I}for(;y>2;)I[n++]=N[v++],I[n++]=N[v++],I[n++]=N[v++],y-=3;y&&(I[n++]=N[v++],y>1&&(I[n++]=N[v++]))}else{v=n-k;do{I[n++]=I[v++],I[n++]=I[v++],I[n++]=I[v++],y-=3}while(y>2);y&&(I[n++]=I[v++],y>1&&(I[n++]=I[v++]))}break}}break}}while(a<s&&n<i);y=f>>3,a-=y,f-=y<<3,u&=(1<<f)-1,e.next_in=a,e.next_out=n,e.avail_in=a<s?s-a+5:5-(a-s),e.avail_out=n<i?i-n+257:257-(n-i),S.hold=u,S.bits=f};const bt=15,wt=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),_t=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),yt=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),kt=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var vt=(e,t,a,s,n,r,i,o)=>{const l=o.bits;let c,h,d,u,f,p,g=0,m=0,b=0,w=0,_=0,y=0,k=0,v=0,N=0,T=0,I=null;const S=new Uint16Array(16),x=new Uint16Array(16);let E,A,O,B=null;for(g=0;g<=bt;g++)S[g]=0;for(m=0;m<s;m++)S[t[a+m]]++;for(_=l,w=bt;w>=1&&0===S[w];w--);if(_>w&&(_=w),0===w)return n[r++]=20971520,n[r++]=20971520,o.bits=1,0;for(b=1;b<w&&0===S[b];b++);for(_<b&&(_=b),v=1,g=1;g<=bt;g++)if(v<<=1,v-=S[g],v<0)return-1;if(v>0&&(0===e||1!==w))return-1;for(x[1]=0,g=1;g<bt;g++)x[g+1]=x[g]+S[g];for(m=0;m<s;m++)0!==t[a+m]&&(i[x[t[a+m]]++]=m);if(0===e?(I=B=i,p=20):1===e?(I=wt,B=_t,p=257):(I=yt,B=kt,p=0),T=0,m=0,g=b,f=r,y=_,k=0,d=-1,N=1<<_,u=N-1,1===e&&N>852||2===e&&N>592)return 1;for(;;){E=g-k,i[m]+1<p?(A=0,O=i[m]):i[m]>=p?(A=B[i[m]-p],O=I[i[m]-p]):(A=96,O=0),c=1<<g-k,h=1<<y,b=h;do{h-=c,n[f+(T>>k)+h]=E<<24|A<<16|O|0}while(0!==h);for(c=1<<g-1;T&c;)c>>=1;if(0!==c?(T&=c-1,T+=c):T=0,m++,0==--S[g]){if(g===w)break;g=t[a+i[m]]}if(g>_&&(T&u)!==d){for(0===k&&(k=_),f+=b,y=g-k,v=1<<y;y+k<w&&(v-=S[y+k],!(v<=0));)y++,v<<=1;if(N+=1<<y,1===e&&N>852||2===e&&N>592)return 1;d=T&u,n[d]=_<<24|y<<16|f-r|0}}return 0!==T&&(n[f+T]=g-k<<24|64<<16|0),o.bits=_,0};const{Z_FINISH:Nt,Z_BLOCK:Tt,Z_TREES:It,Z_OK:St,Z_STREAM_END:xt,Z_NEED_DICT:Et,Z_STREAM_ERROR:At,Z_DATA_ERROR:Ot,Z_MEM_ERROR:Bt,Z_BUF_ERROR:Ut,Z_DEFLATED:Rt}=Y,Lt=16180,Ct=16190,Dt=16191,$t=16192,zt=16194,Ft=16199,Vt=16200,jt=16206,Pt=16209,Zt=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function Mt(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Ht=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<Lt||t.mode>16211?1:0},Kt=e=>{if(Ht(e))return At;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=Lt,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,St},Xt=e=>{if(Ht(e))return At;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,Kt(e)},Gt=(e,t)=>{let a;if(Ht(e))return At;const s=e.state;return t<0?(a=0,t=-t):(a=5+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?At:(null!==s.window&&s.wbits!==t&&(s.window=null),s.wrap=a,s.wbits=t,Xt(e))},qt=(e,t)=>{if(!e)return At;const a=new Mt;e.state=a,a.strm=e,a.window=null,a.mode=Lt;const s=Gt(e,t);return s!==St&&(e.state=null),s};let Wt,Jt,Yt=!0;const Qt=e=>{if(Yt){Wt=new Int32Array(512),Jt=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(vt(1,e.lens,0,288,Wt,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;vt(2,e.lens,0,32,Jt,0,e.work,{bits:5}),Yt=!1}e.lencode=Wt,e.lenbits=9,e.distcode=Jt,e.distbits=5},ea=(e,t,a,s)=>{let n;const r=e.state;return null===r.window&&(r.wsize=1<<r.wbits,r.wnext=0,r.whave=0,r.window=new Uint8Array(r.wsize)),s>=r.wsize?(r.window.set(t.subarray(a-r.wsize,a),0),r.wnext=0,r.whave=r.wsize):(n=r.wsize-r.wnext,n>s&&(n=s),r.window.set(t.subarray(a-s,a-s+n),r.wnext),(s-=n)?(r.window.set(t.subarray(a-s,a),0),r.wnext=s,r.whave=r.wsize):(r.wnext+=n,r.wnext===r.wsize&&(r.wnext=0),r.whave<r.wsize&&(r.whave+=n))),0};var ta={inflateReset:Xt,inflateReset2:Gt,inflateResetKeep:Kt,inflateInit:e=>qt(e,15),inflateInit2:qt,inflate:(e,t)=>{let a,s,n,r,i,o,l,c,h,d,u,f,p,g,m,b,w,_,y,k,v,N,T=0;const I=new Uint8Array(4);let S,x;const E=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Ht(e)||!e.output||!e.input&&0!==e.avail_in)return At;a=e.state,a.mode===Dt&&(a.mode=$t),i=e.next_out,n=e.output,l=e.avail_out,r=e.next_in,s=e.input,o=e.avail_in,c=a.hold,h=a.bits,d=o,u=l,N=St;e:for(;;)switch(a.mode){case Lt:if(0===a.wrap){a.mode=$t;break}for(;h<16;){if(0===o)break e;o--,c+=s[r++]<<h,h+=8}if(2&a.wrap&&35615===c){0===a.wbits&&(a.wbits=15),a.check=0,I[0]=255&c,I[1]=c>>>8&255,a.check=W(a.check,I,2,0),c=0,h=0,a.mode=16181;break}if(a.head&&(a.head.done=!1),!(1&a.wrap)||(((255&c)<<8)+(c>>8))%31){e.msg="incorrect header check",a.mode=Pt;break}if((15&c)!==Rt){e.msg="unknown compression method",a.mode=Pt;break}if(c>>>=4,h-=4,v=8+(15&c),0===a.wbits&&(a.wbits=v),v>15||v>a.wbits){e.msg="invalid window size",a.mode=Pt;break}a.dmax=1<<a.wbits,a.flags=0,e.adler=a.check=1,a.mode=512&c?16189:Dt,c=0,h=0;break;case 16181:for(;h<16;){if(0===o)break e;o--,c+=s[r++]<<h,h+=8}if(a.flags=c,(255&a.flags)!==Rt){e.msg="unknown compression method",a.mode=Pt;break}if(57344&a.flags){e.msg="unknown header flags set",a.mode=Pt;break}a.head&&(a.head.text=c>>8&1),512&a.flags&&4&a.wrap&&(I[0]=255&c,I[1]=c>>>8&255,a.check=W(a.check,I,2,0)),c=0,h=0,a.mode=16182;case 16182:for(;h<32;){if(0===o)break e;o--,c+=s[r++]<<h,h+=8}a.head&&(a.head.time=c),512&a.flags&&4&a.wrap&&(I[0]=255&c,I[1]=c>>>8&255,I[2]=c>>>16&255,I[3]=c>>>24&255,a.check=W(a.check,I,4,0)),c=0,h=0,a.mode=16183;case 16183:for(;h<16;){if(0===o)break e;o--,c+=s[r++]<<h,h+=8}a.head&&(a.head.xflags=255&c,a.head.os=c>>8),512&a.flags&&4&a.wrap&&(I[0]=255&c,I[1]=c>>>8&255,a.check=W(a.check,I,2,0)),c=0,h=0,a.mode=16184;case 16184:if(1024&a.flags){for(;h<16;){if(0===o)break e;o--,c+=s[r++]<<h,h+=8}a.length=c,a.head&&(a.head.extra_len=c),512&a.flags&&4&a.wrap&&(I[0]=255&c,I[1]=c>>>8&255,a.check=W(a.check,I,2,0)),c=0,h=0}else a.head&&(a.head.extra=null);a.mode=16185;case 16185:if(1024&a.flags&&(f=a.length,f>o&&(f=o),f&&(a.head&&(v=a.head.extra_len-a.length,a.head.extra||(a.head.extra=new Uint8Array(a.head.extra_len)),a.head.extra.set(s.subarray(r,r+f),v)),512&a.flags&&4&a.wrap&&(a.check=W(a.check,s,f,r)),o-=f,r+=f,a.length-=f),a.length))break e;a.length=0,a.mode=16186;case 16186:if(2048&a.flags){if(0===o)break e;f=0;do{v=s[r+f++],a.head&&v&&a.length<65536&&(a.head.name+=String.fromCharCode(v))}while(v&&f<o);if(512&a.flags&&4&a.wrap&&(a.check=W(a.check,s,f,r)),o-=f,r+=f,v)break e}else a.head&&(a.head.name=null);a.length=0,a.mode=16187;case 16187:if(4096&a.flags){if(0===o)break e;f=0;do{v=s[r+f++],a.head&&v&&a.length<65536&&(a.head.comment+=String.fromCharCode(v))}while(v&&f<o);if(512&a.flags&&4&a.wrap&&(a.check=W(a.check,s,f,r)),o-=f,r+=f,v)break e}else a.head&&(a.head.comment=null);a.mode=16188;case 16188:if(512&a.flags){for(;h<16;){if(0===o)break e;o--,c+=s[r++]<<h,h+=8}if(4&a.wrap&&c!==(65535&a.check)){e.msg="header crc mismatch",a.mode=Pt;break}c=0,h=0}a.head&&(a.head.hcrc=a.flags>>9&1,a.head.done=!0),e.adler=a.check=0,a.mode=Dt;break;case 16189:for(;h<32;){if(0===o)break e;o--,c+=s[r++]<<h,h+=8}e.adler=a.check=Zt(c),c=0,h=0,a.mode=Ct;case Ct:if(0===a.havedict)return e.next_out=i,e.avail_out=l,e.next_in=r,e.avail_in=o,a.hold=c,a.bits=h,Et;e.adler=a.check=1,a.mode=Dt;case Dt:if(t===Tt||t===It)break e;case $t:if(a.last){c>>>=7&h,h-=7&h,a.mode=jt;break}for(;h<3;){if(0===o)break e;o--,c+=s[r++]<<h,h+=8}switch(a.last=1&c,c>>>=1,h-=1,3&c){case 0:a.mode=16193;break;case 1:if(Qt(a),a.mode=Ft,t===It){c>>>=2,h-=2;break e}break;case 2:a.mode=16196;break;case 3:e.msg="invalid block type",a.mode=Pt}c>>>=2,h-=2;break;case 16193:for(c>>>=7&h,h-=7&h;h<32;){if(0===o)break e;o--,c+=s[r++]<<h,h+=8}if((65535&c)!=(c>>>16^65535)){e.msg="invalid stored block lengths",a.mode=Pt;break}if(a.length=65535&c,c=0,h=0,a.mode=zt,t===It)break e;case zt:a.mode=16195;case 16195:if(f=a.length,f){if(f>o&&(f=o),f>l&&(f=l),0===f)break e;n.set(s.subarray(r,r+f),i),o-=f,r+=f,l-=f,i+=f,a.length-=f;break}a.mode=Dt;break;case 16196:for(;h<14;){if(0===o)break e;o--,c+=s[r++]<<h,h+=8}if(a.nlen=257+(31&c),c>>>=5,h-=5,a.ndist=1+(31&c),c>>>=5,h-=5,a.ncode=4+(15&c),c>>>=4,h-=4,a.nlen>286||a.ndist>30){e.msg="too many length or distance symbols",a.mode=Pt;break}a.have=0,a.mode=16197;case 16197:for(;a.have<a.ncode;){for(;h<3;){if(0===o)break e;o--,c+=s[r++]<<h,h+=8}a.lens[E[a.have++]]=7&c,c>>>=3,h-=3}for(;a.have<19;)a.lens[E[a.have++]]=0;if(a.lencode=a.lendyn,a.lenbits=7,S={bits:a.lenbits},N=vt(0,a.lens,0,19,a.lencode,0,a.work,S),a.lenbits=S.bits,N){e.msg="invalid code lengths set",a.mode=Pt;break}a.have=0,a.mode=16198;case 16198:for(;a.have<a.nlen+a.ndist;){for(;T=a.lencode[c&(1<<a.lenbits)-1],m=T>>>24,b=T>>>16&255,w=65535&T,!(m<=h);){if(0===o)break e;o--,c+=s[r++]<<h,h+=8}if(w<16)c>>>=m,h-=m,a.lens[a.have++]=w;else{if(16===w){for(x=m+2;h<x;){if(0===o)break e;o--,c+=s[r++]<<h,h+=8}if(c>>>=m,h-=m,0===a.have){e.msg="invalid bit length repeat",a.mode=Pt;break}v=a.lens[a.have-1],f=3+(3&c),c>>>=2,h-=2}else if(17===w){for(x=m+3;h<x;){if(0===o)break e;o--,c+=s[r++]<<h,h+=8}c>>>=m,h-=m,v=0,f=3+(7&c),c>>>=3,h-=3}else{for(x=m+7;h<x;){if(0===o)break e;o--,c+=s[r++]<<h,h+=8}c>>>=m,h-=m,v=0,f=11+(127&c),c>>>=7,h-=7}if(a.have+f>a.nlen+a.ndist){e.msg="invalid bit length repeat",a.mode=Pt;break}for(;f--;)a.lens[a.have++]=v}}if(a.mode===Pt)break;if(0===a.lens[256]){e.msg="invalid code -- missing end-of-block",a.mode=Pt;break}if(a.lenbits=9,S={bits:a.lenbits},N=vt(1,a.lens,0,a.nlen,a.lencode,0,a.work,S),a.lenbits=S.bits,N){e.msg="invalid literal/lengths set",a.mode=Pt;break}if(a.distbits=6,a.distcode=a.distdyn,S={bits:a.distbits},N=vt(2,a.lens,a.nlen,a.ndist,a.distcode,0,a.work,S),a.distbits=S.bits,N){e.msg="invalid distances set",a.mode=Pt;break}if(a.mode=Ft,t===It)break e;case Ft:a.mode=Vt;case Vt:if(o>=6&&l>=258){e.next_out=i,e.avail_out=l,e.next_in=r,e.avail_in=o,a.hold=c,a.bits=h,mt(e,u),i=e.next_out,n=e.output,l=e.avail_out,r=e.next_in,s=e.input,o=e.avail_in,c=a.hold,h=a.bits,a.mode===Dt&&(a.back=-1);break}for(a.back=0;T=a.lencode[c&(1<<a.lenbits)-1],m=T>>>24,b=T>>>16&255,w=65535&T,!(m<=h);){if(0===o)break e;o--,c+=s[r++]<<h,h+=8}if(b&&0==(240&b)){for(_=m,y=b,k=w;T=a.lencode[k+((c&(1<<_+y)-1)>>_)],m=T>>>24,b=T>>>16&255,w=65535&T,!(_+m<=h);){if(0===o)break e;o--,c+=s[r++]<<h,h+=8}c>>>=_,h-=_,a.back+=_}if(c>>>=m,h-=m,a.back+=m,a.length=w,0===b){a.mode=16205;break}if(32&b){a.back=-1,a.mode=Dt;break}if(64&b){e.msg="invalid literal/length code",a.mode=Pt;break}a.extra=15&b,a.mode=16201;case 16201:if(a.extra){for(x=a.extra;h<x;){if(0===o)break e;o--,c+=s[r++]<<h,h+=8}a.length+=c&(1<<a.extra)-1,c>>>=a.extra,h-=a.extra,a.back+=a.extra}a.was=a.length,a.mode=16202;case 16202:for(;T=a.distcode[c&(1<<a.distbits)-1],m=T>>>24,b=T>>>16&255,w=65535&T,!(m<=h);){if(0===o)break e;o--,c+=s[r++]<<h,h+=8}if(0==(240&b)){for(_=m,y=b,k=w;T=a.distcode[k+((c&(1<<_+y)-1)>>_)],m=T>>>24,b=T>>>16&255,w=65535&T,!(_+m<=h);){if(0===o)break e;o--,c+=s[r++]<<h,h+=8}c>>>=_,h-=_,a.back+=_}if(c>>>=m,h-=m,a.back+=m,64&b){e.msg="invalid distance code",a.mode=Pt;break}a.offset=w,a.extra=15&b,a.mode=16203;case 16203:if(a.extra){for(x=a.extra;h<x;){if(0===o)break e;o--,c+=s[r++]<<h,h+=8}a.offset+=c&(1<<a.extra)-1,c>>>=a.extra,h-=a.extra,a.back+=a.extra}if(a.offset>a.dmax){e.msg="invalid distance too far back",a.mode=Pt;break}a.mode=16204;case 16204:if(0===l)break e;if(f=u-l,a.offset>f){if(f=a.offset-f,f>a.whave&&a.sane){e.msg="invalid distance too far back",a.mode=Pt;break}f>a.wnext?(f-=a.wnext,p=a.wsize-f):p=a.wnext-f,f>a.length&&(f=a.length),g=a.window}else g=n,p=i-a.offset,f=a.length;f>l&&(f=l),l-=f,a.length-=f;do{n[i++]=g[p++]}while(--f);0===a.length&&(a.mode=Vt);break;case 16205:if(0===l)break e;n[i++]=a.length,l--,a.mode=Vt;break;case jt:if(a.wrap){for(;h<32;){if(0===o)break e;o--,c|=s[r++]<<h,h+=8}if(u-=l,e.total_out+=u,a.total+=u,4&a.wrap&&u&&(e.adler=a.check=a.flags?W(a.check,n,u,i-u):G(a.check,n,u,i-u)),u=l,4&a.wrap&&(a.flags?c:Zt(c))!==a.check){e.msg="incorrect data check",a.mode=Pt;break}c=0,h=0}a.mode=16207;case 16207:if(a.wrap&&a.flags){for(;h<32;){if(0===o)break e;o--,c+=s[r++]<<h,h+=8}if(4&a.wrap&&c!==(4294967295&a.total)){e.msg="incorrect length check",a.mode=Pt;break}c=0,h=0}a.mode=16208;case 16208:N=xt;break e;case Pt:N=Ot;break e;case 16210:return Bt;default:return At}return e.next_out=i,e.avail_out=l,e.next_in=r,e.avail_in=o,a.hold=c,a.bits=h,(a.wsize||u!==e.avail_out&&a.mode<Pt&&(a.mode<jt||t!==Nt))&&ea(e,e.output,e.next_out,u-e.avail_out),d-=e.avail_in,u-=e.avail_out,e.total_in+=d,e.total_out+=u,a.total+=u,4&a.wrap&&u&&(e.adler=a.check=a.flags?W(a.check,n,u,e.next_out-u):G(a.check,n,u,e.next_out-u)),e.data_type=a.bits+(a.last?64:0)+(a.mode===Dt?128:0)+(a.mode===Ft||a.mode===zt?256:0),(0===d&&0===u||t===Nt)&&N===St&&(N=Ut),N},inflateEnd:e=>{if(Ht(e))return At;let t=e.state;return t.window&&(t.window=null),e.state=null,St},inflateGetHeader:(e,t)=>{if(Ht(e))return At;const a=e.state;return 0==(2&a.wrap)?At:(a.head=t,t.done=!1,St)},inflateSetDictionary:(e,t)=>{const a=t.length;let s,n,r;return Ht(e)?At:(s=e.state,0!==s.wrap&&s.mode!==Ct?At:s.mode===Ct&&(n=1,n=G(n,t,a,0),n!==s.check)?Ot:(r=ea(e,t,a,a),r?(s.mode=16210,Bt):(s.havedict=1,St)))},inflateInfo:"pako inflate (from Nodeca project)"};var aa=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const sa=Object.prototype.toString,{Z_NO_FLUSH:na,Z_FINISH:ra,Z_OK:ia,Z_STREAM_END:oa,Z_NEED_DICT:la,Z_STREAM_ERROR:ca,Z_DATA_ERROR:ha,Z_MEM_ERROR:da}=Y;function ua(e){this.options=Je.assign({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new tt,this.strm.avail_out=0;let a=ta.inflateInit2(this.strm,t.windowBits);if(a!==ia)throw new Error(J[a]);if(this.header=new aa,ta.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=et.string2buf(t.dictionary):"[object ArrayBuffer]"===sa.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(a=ta.inflateSetDictionary(this.strm,t.dictionary),a!==ia)))throw new Error(J[a])}function fa(e,t){const a=new ua(t);if(a.push(e),a.err)throw a.msg||J[a.err];return a.result}ua.prototype.push=function(e,t){const a=this.strm,s=this.options.chunkSize,n=this.options.dictionary;let r,i,o;if(this.ended)return!1;for(i=t===~~t?t:!0===t?ra:na,"[object ArrayBuffer]"===sa.call(e)?a.input=new Uint8Array(e):a.input=e,a.next_in=0,a.avail_in=a.input.length;;){for(0===a.avail_out&&(a.output=new Uint8Array(s),a.next_out=0,a.avail_out=s),r=ta.inflate(a,i),r===la&&n&&(r=ta.inflateSetDictionary(a,n),r===ia?r=ta.inflate(a,i):r===ha&&(r=la));a.avail_in>0&&r===oa&&a.state.wrap>0&&0!==e[a.next_in];)ta.inflateReset(a),r=ta.inflate(a,i);switch(r){case ca:case ha:case la:case da:return this.onEnd(r),this.ended=!0,!1}if(o=a.avail_out,a.next_out&&(0===a.avail_out||r===oa))if("string"===this.options.to){let e=et.utf8border(a.output,a.next_out),t=a.next_out-e,n=et.buf2string(a.output,e);a.next_out=t,a.avail_out=s-t,t&&a.output.set(a.output.subarray(e,e+t),0),this.onData(n)}else this.onData(a.output.length===a.next_out?a.output:a.output.subarray(0,a.next_out));if(r!==ia||0!==o){if(r===oa)return r=ta.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,!0;if(0===a.avail_in)break}}return!0},ua.prototype.onData=function(e){this.chunks.push(e)},ua.prototype.onEnd=function(e){e===ia&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=Je.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var pa={Inflate:ua,inflate:fa,inflateRaw:function(e,t){return(t=t||{}).raw=!0,fa(e,t)},ungzip:fa,constants:Y};const{Deflate:ga,deflate:ma,deflateRaw:ba,gzip:wa}=pt,{Inflate:_a,inflate:ya,inflateRaw:ka,ungzip:va}=pa;var Na={Deflate:ga,deflate:ma,deflateRaw:ba,gzip:wa,Inflate:_a,inflate:ya,inflateRaw:ka,ungzip:va,constants:Y};function Ta(e){let t=typeof e;if("object"==t){if(Array.isArray(e))return"array";if(null===e)return"null"}return t}let Ia="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),Sa=[];for(let e=0;e<Ia.length;e++)Sa[Ia[e].charCodeAt(0)]=e;var xa,Ea;function Aa(){let e=0,t=0;for(let a=0;a<28;a+=7){let s=this.buf[this.pos++];if(e|=(127&s)<<a,0==(128&s))return this.assertBounds(),[e,t]}let a=this.buf[this.pos++];if(e|=(15&a)<<28,t=(112&a)>>4,0==(128&a))return this.assertBounds(),[e,t];for(let a=3;a<=31;a+=7){let s=this.buf[this.pos++];if(t|=(127&s)<<a,0==(128&s))return this.assertBounds(),[e,t]}throw new Error("invalid varint")}function Oa(e,t,a){for(let s=0;s<28;s+=7){const n=e>>>s,r=!(n>>>7==0&&0==t),i=255&(r?128|n:n);if(a.push(i),!r)return}const s=e>>>28&15|(7&t)<<4,n=!(t>>3==0);if(a.push(255&(n?128|s:s)),n){for(let e=3;e<31;e+=7){const s=t>>>e,n=!(s>>>7==0),r=255&(n?128|s:s);if(a.push(r),!n)return}a.push(t>>>31&1)}}Sa["-".charCodeAt(0)]=Ia.indexOf("+"),Sa["_".charCodeAt(0)]=Ia.indexOf("/"),function(e){e.symbol=Symbol.for("protobuf-ts/unknown"),e.onRead=(a,s,n,r,i)=>{(t(s)?s[e.symbol]:s[e.symbol]=[]).push({no:n,wireType:r,data:i})},e.onWrite=(t,a,s)=>{for(let{no:t,wireType:n,data:r}of e.list(a))s.tag(t,n).raw(r)},e.list=(a,s)=>{if(t(a)){let t=a[e.symbol];return s?t.filter((e=>e.no==s)):t}return[]},e.last=(t,a)=>e.list(t,a).slice(-1)[0];const t=t=>t&&Array.isArray(t[e.symbol])}(xa||(xa={})),function(e){e[e.Varint=0]="Varint",e[e.Bit64=1]="Bit64",e[e.LengthDelimited=2]="LengthDelimited",e[e.StartGroup=3]="StartGroup",e[e.EndGroup=4]="EndGroup",e[e.Bit32=5]="Bit32"}(Ea||(Ea={}));const Ba=4294967296;function Ua(e){let t="-"==e[0];t&&(e=e.slice(1));const a=1e6;let s=0,n=0;function r(t,r){const i=Number(e.slice(t,r));n*=a,s=s*a+i,s>=Ba&&(n+=s/Ba|0,s%=Ba)}return r(-24,-18),r(-18,-12),r(-12,-6),r(-6),[t,s,n]}function Ra(e,t){if(t>>>0<=2097151)return""+(Ba*t+(e>>>0));let a=(e>>>24|t<<8)>>>0&16777215,s=t>>16&65535,n=(16777215&e)+6777216*a+6710656*s,r=a+8147497*s,i=2*s,o=1e7;function l(e,t){let a=e?String(e):"";return t?"0000000".slice(a.length)+a:a}return n>=o&&(r+=Math.floor(n/o),n%=o),r>=o&&(i+=Math.floor(r/o),r%=o),l(i,0)+l(r,i)+l(n,1)}function La(e,t){if(e>=0){for(;e>127;)t.push(127&e|128),e>>>=7;t.push(e)}else{for(let a=0;a<9;a++)t.push(127&e|128),e>>=7;t.push(1)}}function Ca(){let e=this.buf[this.pos++],t=127&e;if(0==(128&e))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(127&e)<<7,0==(128&e))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(127&e)<<14,0==(128&e))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(127&e)<<21,0==(128&e))return this.assertBounds(),t;e=this.buf[this.pos++],t|=(15&e)<<28;for(let t=5;0!=(128&e)&&t<10;t++)e=this.buf[this.pos++];if(0!=(128&e))throw new Error("invalid varint");return this.assertBounds(),t>>>0}let Da;function $a(e){if(!e)throw new Error("BigInt unavailable, see https://github.com/timostamm/protobuf-ts/blob/v1.0.8/MANUAL.md#bigint-support")}!function(){const e=new DataView(new ArrayBuffer(8)),t=void 0!==globalThis.BigInt&&"function"==typeof e.getBigInt64&&"function"==typeof e.getBigUint64&&"function"==typeof e.setBigInt64&&"function"==typeof e.setBigUint64;Da=t?{MIN:BigInt("-9223372036854775808"),MAX:BigInt("9223372036854775807"),UMIN:BigInt("0"),UMAX:BigInt("18446744073709551615"),C:BigInt,V:e}:void 0}();const za=/^-?[0-9]+$/,Fa=4294967296,Va=2147483648;class ja{constructor(e,t){this.lo=0|e,this.hi=0|t}isZero(){return 0==this.lo&&0==this.hi}toNumber(){let e=this.hi*Fa+(this.lo>>>0);if(!Number.isSafeInteger(e))throw new Error("cannot convert to safe number");return e}}class Pa extends ja{static from(e){if(Da)switch(typeof e){case"string":if("0"==e)return this.ZERO;if(""==e)throw new Error("string is no integer");e=Da.C(e);case"number":if(0===e)return this.ZERO;e=Da.C(e);case"bigint":if(!e)return this.ZERO;if(e<Da.UMIN)throw new Error("signed value for ulong");if(e>Da.UMAX)throw new Error("ulong too large");return Da.V.setBigUint64(0,e,!0),new Pa(Da.V.getInt32(0,!0),Da.V.getInt32(4,!0))}else switch(typeof e){case"string":if("0"==e)return this.ZERO;if(e=e.trim(),!za.test(e))throw new Error("string is no integer");let[t,a,s]=Ua(e);if(t)throw new Error("signed value for ulong");return new Pa(a,s);case"number":if(0==e)return this.ZERO;if(!Number.isSafeInteger(e))throw new Error("number is no integer");if(e<0)throw new Error("signed value for ulong");return new Pa(e,e/Fa)}throw new Error("unknown value "+typeof e)}toString(){return Da?this.toBigInt().toString():Ra(this.lo,this.hi)}toBigInt(){return $a(Da),Da.V.setInt32(0,this.lo,!0),Da.V.setInt32(4,this.hi,!0),Da.V.getBigUint64(0,!0)}}Pa.ZERO=new Pa(0,0);class Za extends ja{static from(e){if(Da)switch(typeof e){case"string":if("0"==e)return this.ZERO;if(""==e)throw new Error("string is no integer");e=Da.C(e);case"number":if(0===e)return this.ZERO;e=Da.C(e);case"bigint":if(!e)return this.ZERO;if(e<Da.MIN)throw new Error("signed long too small");if(e>Da.MAX)throw new Error("signed long too large");return Da.V.setBigInt64(0,e,!0),new Za(Da.V.getInt32(0,!0),Da.V.getInt32(4,!0))}else switch(typeof e){case"string":if("0"==e)return this.ZERO;if(e=e.trim(),!za.test(e))throw new Error("string is no integer");let[t,a,s]=Ua(e);if(t){if(s>Va||s==Va&&0!=a)throw new Error("signed long too small")}else if(s>=Va)throw new Error("signed long too large");let n=new Za(a,s);return t?n.negate():n;case"number":if(0==e)return this.ZERO;if(!Number.isSafeInteger(e))throw new Error("number is no integer");return e>0?new Za(e,e/Fa):new Za(-e,-e/Fa).negate()}throw new Error("unknown value "+typeof e)}isNegative(){return 0!=(this.hi&Va)}negate(){let e=~this.hi,t=this.lo;return t?t=1+~t:e+=1,new Za(t,e)}toString(){if(Da)return this.toBigInt().toString();if(this.isNegative()){let e=this.negate();return"-"+Ra(e.lo,e.hi)}return Ra(this.lo,this.hi)}toBigInt(){return $a(Da),Da.V.setInt32(0,this.lo,!0),Da.V.setInt32(4,this.hi,!0),Da.V.getBigInt64(0,!0)}}Za.ZERO=new Za(0,0);const Ma={readUnknownField:!0,readerFactory:e=>new Ha(e)};class Ha{constructor(e,t){this.varint64=Aa,this.uint32=Ca,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=null!=t?t:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0})}tag(){let e=this.uint32(),t=e>>>3,a=7&e;if(t<=0||a<0||a>5)throw new Error("illegal tag: field no "+t+" wire type "+a);return[t,a]}skip(e){let t=this.pos;switch(e){case Ea.Varint:for(;128&this.buf[this.pos++];);break;case Ea.Bit64:this.pos+=4;case Ea.Bit32:this.pos+=4;break;case Ea.LengthDelimited:let t=this.uint32();this.pos+=t;break;case Ea.StartGroup:let a;for(;(a=this.tag()[1])!==Ea.EndGroup;)this.skip(a);break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(t,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return 0|this.uint32()}sint32(){let e=this.uint32();return e>>>1^-(1&e)}int64(){return new Za(...this.varint64())}uint64(){return new Pa(...this.varint64())}sint64(){let[e,t]=this.varint64(),a=-(1&e);return e=(e>>>1|(1&t)<<31)^a,t=t>>>1^a,new Za(e,t)}bool(){let[e,t]=this.varint64();return 0!==e||0!==t}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return new Pa(this.sfixed32(),this.sfixed32())}sfixed64(){return new Za(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),t=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(t,t+e)}string(){return this.textDecoder.decode(this.bytes())}}function Ka(e,t){if(!e)throw new Error(t)}function Xa(e){if("number"!=typeof e)throw new Error("invalid int 32: "+typeof e);if(!Number.isInteger(e)||e>2147483647||e<-2147483648)throw new Error("invalid int 32: "+e)}function Ga(e){if("number"!=typeof e)throw new Error("invalid uint 32: "+typeof e);if(!Number.isInteger(e)||e>4294967295||e<0)throw new Error("invalid uint 32: "+e)}function qa(e){if("number"!=typeof e)throw new Error("invalid float 32: "+typeof e);if(Number.isFinite(e)&&(e>34028234663852886e22||e<-34028234663852886e22))throw new Error("invalid float 32: "+e)}const Wa={writeUnknownFields:!0,writerFactory:()=>new Ja};class Ja{constructor(e){this.stack=[],this.textEncoder=null!=e?e:new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let t=0;t<this.chunks.length;t++)e+=this.chunks[t].length;let t=new Uint8Array(e),a=0;for(let e=0;e<this.chunks.length;e++)t.set(this.chunks[e],a),a+=this.chunks[e].length;return this.chunks=[],t}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),t=this.stack.pop();if(!t)throw new Error("invalid state, fork stack empty");return this.chunks=t.chunks,this.buf=t.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,t){return this.uint32((e<<3|t)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(Ga(e);e>127;)this.buf.push(127&e|128),e>>>=7;return this.buf.push(e),this}int32(e){return Xa(e),La(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let t=this.textEncoder.encode(e);return this.uint32(t.byteLength),this.raw(t)}float(e){qa(e);let t=new Uint8Array(4);return new DataView(t.buffer).setFloat32(0,e,!0),this.raw(t)}double(e){let t=new Uint8Array(8);return new DataView(t.buffer).setFloat64(0,e,!0),this.raw(t)}fixed32(e){Ga(e);let t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,e,!0),this.raw(t)}sfixed32(e){Xa(e);let t=new Uint8Array(4);return new DataView(t.buffer).setInt32(0,e,!0),this.raw(t)}sint32(e){return Xa(e),La(e=(e<<1^e>>31)>>>0,this.buf),this}sfixed64(e){let t=new Uint8Array(8),a=new DataView(t.buffer),s=Za.from(e);return a.setInt32(0,s.lo,!0),a.setInt32(4,s.hi,!0),this.raw(t)}fixed64(e){let t=new Uint8Array(8),a=new DataView(t.buffer),s=Pa.from(e);return a.setInt32(0,s.lo,!0),a.setInt32(4,s.hi,!0),this.raw(t)}int64(e){let t=Za.from(e);return Oa(t.lo,t.hi,this.buf),this}sint64(e){let t=Za.from(e),a=t.hi>>31;return Oa(t.lo<<1^a,(t.hi<<1|t.lo>>>31)^a,this.buf),this}uint64(e){let t=Pa.from(e);return Oa(t.lo,t.hi,this.buf),this}}const Ya={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0},Qa={ignoreUnknownFields:!1};const es=Symbol.for("protobuf-ts/message-type");function ts(e){let t=!1;const a=[];for(let s=0;s<e.length;s++){let n=e.charAt(s);"_"==n?t=!0:/\d/.test(n)?(a.push(n),t=!0):t?(a.push(n.toUpperCase()),t=!1):0==s?a.push(n.toLowerCase()):a.push(n)}return a.join("")}var as,ss,ns;function rs(e){var t,a,s,n;return e.localName=null!==(t=e.localName)&&void 0!==t?t:ts(e.name),e.jsonName=null!==(a=e.jsonName)&&void 0!==a?a:ts(e.name),e.repeat=null!==(s=e.repeat)&&void 0!==s?s:ns.NO,e.opt=null!==(n=e.opt)&&void 0!==n?n:!e.repeat&&(!e.oneof&&"message"==e.kind),e}function is(e){if("object"!=typeof e||null===e||!e.hasOwnProperty("oneofKind"))return!1;switch(typeof e.oneofKind){case"string":return void 0!==e[e.oneofKind]&&2==Object.keys(e).length;case"undefined":return 1==Object.keys(e).length;default:return!1}}!function(e){e[e.DOUBLE=1]="DOUBLE",e[e.FLOAT=2]="FLOAT",e[e.INT64=3]="INT64",e[e.UINT64=4]="UINT64",e[e.INT32=5]="INT32",e[e.FIXED64=6]="FIXED64",e[e.FIXED32=7]="FIXED32",e[e.BOOL=8]="BOOL",e[e.STRING=9]="STRING",e[e.BYTES=12]="BYTES",e[e.UINT32=13]="UINT32",e[e.SFIXED32=15]="SFIXED32",e[e.SFIXED64=16]="SFIXED64",e[e.SINT32=17]="SINT32",e[e.SINT64=18]="SINT64"}(as||(as={})),function(e){e[e.BIGINT=0]="BIGINT",e[e.STRING=1]="STRING",e[e.NUMBER=2]="NUMBER"}(ss||(ss={})),function(e){e[e.NO=0]="NO",e[e.PACKED=1]="PACKED",e[e.UNPACKED=2]="UNPACKED"}(ns||(ns={}));class os{constructor(e){var t;this.fields=null!==(t=e.fields)&&void 0!==t?t:[]}prepare(){if(this.data)return;const e=[],t=[],a=[];for(let s of this.fields)if(s.oneof)a.includes(s.oneof)||(a.push(s.oneof),e.push(s.oneof),t.push(s.oneof));else switch(t.push(s.localName),s.kind){case"scalar":case"enum":s.opt&&!s.repeat||e.push(s.localName);break;case"message":s.repeat&&e.push(s.localName);break;case"map":e.push(s.localName)}this.data={req:e,known:t,oneofs:Object.values(a)}}is(e,t,a=!1){if(t<0)return!0;if(null==e||"object"!=typeof e)return!1;this.prepare();let s=Object.keys(e),n=this.data;if(s.length<n.req.length||n.req.some((e=>!s.includes(e))))return!1;if(!a&&s.some((e=>!n.known.includes(e))))return!1;if(t<1)return!0;for(const s of n.oneofs){const n=e[s];if(!is(n))return!1;if(void 0===n.oneofKind)continue;const r=this.fields.find((e=>e.localName===n.oneofKind));if(!r)return!1;if(!this.field(n[n.oneofKind],r,a,t))return!1}for(const s of this.fields)if(void 0===s.oneof&&!this.field(e[s.localName],s,a,t))return!1;return!0}field(e,t,a,s){let n=t.repeat;switch(t.kind){case"scalar":return void 0===e?t.opt:n?this.scalars(e,t.T,s,t.L):this.scalar(e,t.T,t.L);case"enum":return void 0===e?t.opt:n?this.scalars(e,as.INT32,s):this.scalar(e,as.INT32);case"message":return void 0===e||(n?this.messages(e,t.T(),a,s):this.message(e,t.T(),a,s));case"map":if("object"!=typeof e||null===e)return!1;if(s<2)return!0;if(!this.mapKeys(e,t.K,s))return!1;switch(t.V.kind){case"scalar":return this.scalars(Object.values(e),t.V.T,s,t.V.L);case"enum":return this.scalars(Object.values(e),as.INT32,s);case"message":return this.messages(Object.values(e),t.V.T(),a,s)}}return!0}message(e,t,a,s){return a?t.isAssignable(e,s):t.is(e,s)}messages(e,t,a,s){if(!Array.isArray(e))return!1;if(s<2)return!0;if(a){for(let a=0;a<e.length&&a<s;a++)if(!t.isAssignable(e[a],s-1))return!1}else for(let a=0;a<e.length&&a<s;a++)if(!t.is(e[a],s-1))return!1;return!0}scalar(e,t,a){let s=typeof e;switch(t){case as.UINT64:case as.FIXED64:case as.INT64:case as.SFIXED64:case as.SINT64:switch(a){case ss.BIGINT:return"bigint"==s;case ss.NUMBER:return"number"==s&&!isNaN(e);default:return"string"==s}case as.BOOL:return"boolean"==s;case as.STRING:return"string"==s;case as.BYTES:return e instanceof Uint8Array;case as.DOUBLE:case as.FLOAT:return"number"==s&&!isNaN(e);default:return"number"==s&&Number.isInteger(e)}}scalars(e,t,a,s){if(!Array.isArray(e))return!1;if(a<2)return!0;if(Array.isArray(e))for(let n=0;n<e.length&&n<a;n++)if(!this.scalar(e[n],t,s))return!1;return!0}mapKeys(e,t,a){let s=Object.keys(e);switch(t){case as.INT32:case as.FIXED32:case as.SFIXED32:case as.SINT32:case as.UINT32:return this.scalars(s.slice(0,a).map((e=>parseInt(e))),t,a);case as.BOOL:return this.scalars(s.slice(0,a).map((e=>"true"==e||"false"!=e&&e)),t,a);default:return this.scalars(s,t,a,ss.STRING)}}}function ls(e,t){switch(t){case ss.BIGINT:return e.toBigInt();case ss.NUMBER:return e.toNumber();default:return e.toString()}}class cs{constructor(e){this.info=e}prepare(){var e;if(void 0===this.fMap){this.fMap={};const t=null!==(e=this.info.fields)&&void 0!==e?e:[];for(const e of t)this.fMap[e.name]=e,this.fMap[e.jsonName]=e,this.fMap[e.localName]=e}}assert(e,t,a){if(!e){let e=Ta(a);throw"number"!=e&&"boolean"!=e||(e=a.toString()),new Error(`Cannot parse JSON ${e} for ${this.info.typeName}#${t}`)}}read(e,t,a){this.prepare();const s=[];for(const[r,i]of Object.entries(e)){const e=this.fMap[r];if(!e){if(!a.ignoreUnknownFields)throw new Error(`Found unknown field while reading ${this.info.typeName} from JSON format. JSON key: ${r}`);continue}const o=e.localName;let l;if(e.oneof){if(null===i&&("enum"!==e.kind||"google.protobuf.NullValue"!==e.T()[0]))continue;if(s.includes(e.oneof))throw new Error(`Multiple members of the oneof group "${e.oneof}" of ${this.info.typeName} are present in JSON.`);s.push(e.oneof),l=t[e.oneof]={oneofKind:o}}else l=t;if("map"==e.kind){if(null===i)continue;this.assert(null!==(n=i)&&"object"==typeof n&&!Array.isArray(n),e.name,i);const t=l[o];for(const[s,n]of Object.entries(i)){let r;switch(this.assert(null!==n,e.name+" map value",null),e.V.kind){case"message":r=e.V.T().internalJsonRead(n,a);break;case"enum":if(r=this.enum(e.V.T(),n,e.name,a.ignoreUnknownFields),!1===r)continue;break;case"scalar":r=this.scalar(n,e.V.T,e.V.L,e.name)}this.assert(void 0!==r,e.name+" map value",n);let i=s;e.K==as.BOOL&&(i="true"==i||"false"!=i&&i),i=this.scalar(i,e.K,ss.STRING,e.name).toString(),t[i]=r}}else if(e.repeat){if(null===i)continue;this.assert(Array.isArray(i),e.name,i);const t=l[o];for(const s of i){let n;switch(this.assert(null!==s,e.name,null),e.kind){case"message":n=e.T().internalJsonRead(s,a);break;case"enum":if(n=this.enum(e.T(),s,e.name,a.ignoreUnknownFields),!1===n)continue;break;case"scalar":n=this.scalar(s,e.T,e.L,e.name)}this.assert(void 0!==n,e.name,i),t.push(n)}}else switch(e.kind){case"message":if(null===i&&"google.protobuf.Value"!=e.T().typeName){this.assert(void 0===e.oneof,e.name+" (oneof member)",null);continue}l[o]=e.T().internalJsonRead(i,a,l[o]);break;case"enum":let t=this.enum(e.T(),i,e.name,a.ignoreUnknownFields);if(!1===t)continue;l[o]=t;break;case"scalar":l[o]=this.scalar(i,e.T,e.L,e.name)}}var n}enum(e,t,a,s){if("google.protobuf.NullValue"==e[0]&&Ka(null===t||"NULL_VALUE"===t,`Unable to parse field ${this.info.typeName}#${a}, enum ${e[0]} only accepts null.`),null===t)return 0;switch(typeof t){case"number":return Ka(Number.isInteger(t),`Unable to parse field ${this.info.typeName}#${a}, enum can only be integral number, got ${t}.`),t;case"string":let n=t;e[2]&&t.substring(0,e[2].length)===e[2]&&(n=t.substring(e[2].length));let r=e[1][n];return(void 0!==r||!s)&&(Ka("number"==typeof r,`Unable to parse field ${this.info.typeName}#${a}, enum ${e[0]} has no value for "${t}".`),r)}Ka(!1,`Unable to parse field ${this.info.typeName}#${a}, cannot parse enum value from ${typeof t}".`)}scalar(e,t,a,s){let n;try{switch(t){case as.DOUBLE:case as.FLOAT:if(null===e)return 0;if("NaN"===e)return Number.NaN;if("Infinity"===e)return Number.POSITIVE_INFINITY;if("-Infinity"===e)return Number.NEGATIVE_INFINITY;if(""===e){n="empty string";break}if("string"==typeof e&&e.trim().length!==e.length){n="extra whitespace";break}if("string"!=typeof e&&"number"!=typeof e)break;let s=Number(e);if(Number.isNaN(s)){n="not a number";break}if(!Number.isFinite(s)){n="too large or small";break}return t==as.FLOAT&&qa(s),s;case as.INT32:case as.FIXED32:case as.SFIXED32:case as.SINT32:case as.UINT32:if(null===e)return 0;let r;if("number"==typeof e?r=e:""===e?n="empty string":"string"==typeof e&&(e.trim().length!==e.length?n="extra whitespace":r=Number(e)),void 0===r)break;return t==as.UINT32?Ga(r):Xa(r),r;case as.INT64:case as.SFIXED64:case as.SINT64:if(null===e)return ls(Za.ZERO,a);if("number"!=typeof e&&"string"!=typeof e)break;return ls(Za.from(e),a);case as.FIXED64:case as.UINT64:if(null===e)return ls(Pa.ZERO,a);if("number"!=typeof e&&"string"!=typeof e)break;return ls(Pa.from(e),a);case as.BOOL:if(null===e)return!1;if("boolean"!=typeof e)break;return e;case as.STRING:if(null===e)return"";if("string"!=typeof e){n="extra whitespace";break}try{encodeURIComponent(e)}catch(n){n="invalid UTF8";break}return e;case as.BYTES:if(null===e||""===e)return new Uint8Array(0);if("string"!=typeof e)break;return function(e){let t=3*e.length/4;"="==e[e.length-2]?t-=2:"="==e[e.length-1]&&(t-=1);let a,s=new Uint8Array(t),n=0,r=0,i=0;for(let t=0;t<e.length;t++){if(a=Sa[e.charCodeAt(t)],void 0===a)switch(e[t]){case"=":r=0;case"\n":case"\r":case"\t":case" ":continue;default:throw Error("invalid base64 string.")}switch(r){case 0:i=a,r=1;break;case 1:s[n++]=i<<2|(48&a)>>4,i=a,r=2;break;case 2:s[n++]=(15&i)<<4|(60&a)>>2,i=a,r=3;break;case 3:s[n++]=(3&i)<<6|a,r=0}}if(1==r)throw Error("invalid base64 string.");return s.subarray(0,n)}(e)}}catch(e){n=e.message}this.assert(!1,s+(n?" - "+n:""),e)}}class hs{constructor(e){var t;this.fields=null!==(t=e.fields)&&void 0!==t?t:[]}write(e,t){const a={},s=e;for(const e of this.fields){if(!e.oneof){let n=this.field(e,s[e.localName],t);void 0!==n&&(a[t.useProtoFieldName?e.name:e.jsonName]=n);continue}const n=s[e.oneof];if(n.oneofKind!==e.localName)continue;const r="scalar"==e.kind||"enum"==e.kind?Object.assign(Object.assign({},t),{emitDefaultValues:!0}):t;let i=this.field(e,n[e.localName],r);Ka(void 0!==i),a[t.useProtoFieldName?e.name:e.jsonName]=i}return a}field(e,t,a){let s;if("map"==e.kind){Ka("object"==typeof t&&null!==t);const n={};switch(e.V.kind){case"scalar":for(const[a,s]of Object.entries(t)){const t=this.scalar(e.V.T,s,e.name,!1,!0);Ka(void 0!==t),n[a.toString()]=t}break;case"message":const s=e.V.T();for(const[r,i]of Object.entries(t)){const t=this.message(s,i,e.name,a);Ka(void 0!==t),n[r.toString()]=t}break;case"enum":const r=e.V.T();for(const[s,i]of Object.entries(t)){Ka(void 0===i||"number"==typeof i);const t=this.enum(r,i,e.name,!1,!0,a.enumAsInteger);Ka(void 0!==t),n[s.toString()]=t}}(a.emitDefaultValues||Object.keys(n).length>0)&&(s=n)}else if(e.repeat){Ka(Array.isArray(t));const n=[];switch(e.kind){case"scalar":for(let a=0;a<t.length;a++){const s=this.scalar(e.T,t[a],e.name,e.opt,!0);Ka(void 0!==s),n.push(s)}break;case"enum":const s=e.T();for(let r=0;r<t.length;r++){Ka(void 0===t[r]||"number"==typeof t[r]);const i=this.enum(s,t[r],e.name,e.opt,!0,a.enumAsInteger);Ka(void 0!==i),n.push(i)}break;case"message":const r=e.T();for(let s=0;s<t.length;s++){const i=this.message(r,t[s],e.name,a);Ka(void 0!==i),n.push(i)}}(a.emitDefaultValues||n.length>0||a.emitDefaultValues)&&(s=n)}else switch(e.kind){case"scalar":s=this.scalar(e.T,t,e.name,e.opt,a.emitDefaultValues);break;case"enum":s=this.enum(e.T(),t,e.name,e.opt,a.emitDefaultValues,a.enumAsInteger);break;case"message":s=this.message(e.T(),t,e.name,a)}return s}enum(e,t,a,s,n,r){if("google.protobuf.NullValue"==e[0])return n||s?null:void 0;if(void 0!==t){if(0!==t||n||s)return Ka("number"==typeof t),Ka(Number.isInteger(t)),r||!e[1].hasOwnProperty(t)?t:e[2]?e[2]+e[1][t]:e[1][t]}else Ka(s)}message(e,t,a,s){return void 0===t?s.emitDefaultValues?null:void 0:e.internalJsonWrite(t,s)}scalar(e,t,a,s,n){if(void 0===t)return void Ka(s);const r=n||s;switch(e){case as.INT32:case as.SFIXED32:case as.SINT32:return 0===t?r?0:void 0:(Xa(t),t);case as.FIXED32:case as.UINT32:return 0===t?r?0:void 0:(Ga(t),t);case as.FLOAT:qa(t);case as.DOUBLE:return 0===t?r?0:void 0:(Ka("number"==typeof t),Number.isNaN(t)?"NaN":t===Number.POSITIVE_INFINITY?"Infinity":t===Number.NEGATIVE_INFINITY?"-Infinity":t);case as.STRING:return""===t?r?"":void 0:(Ka("string"==typeof t),t);case as.BOOL:return!1===t?!r&&void 0:(Ka("boolean"==typeof t),t);case as.UINT64:case as.FIXED64:Ka("number"==typeof t||"string"==typeof t||"bigint"==typeof t);let e=Pa.from(t);if(e.isZero()&&!r)return;return e.toString();case as.INT64:case as.SFIXED64:case as.SINT64:Ka("number"==typeof t||"string"==typeof t||"bigint"==typeof t);let a=Za.from(t);if(a.isZero()&&!r)return;return a.toString();case as.BYTES:return Ka(t instanceof Uint8Array),t.byteLength?function(e){let t,a="",s=0,n=0;for(let r=0;r<e.length;r++)switch(t=e[r],s){case 0:a+=Ia[t>>2],n=(3&t)<<4,s=1;break;case 1:a+=Ia[n|t>>4],n=(15&t)<<2,s=2;break;case 2:a+=Ia[n|t>>6],a+=Ia[63&t],s=0}return s&&(a+=Ia[n],a+="=",1==s&&(a+="=")),a}(t):r?"":void 0}}}function ds(e,t=ss.STRING){switch(e){case as.BOOL:return!1;case as.UINT64:case as.FIXED64:return ls(Pa.ZERO,t);case as.INT64:case as.SFIXED64:case as.SINT64:return ls(Za.ZERO,t);case as.DOUBLE:case as.FLOAT:return 0;case as.BYTES:return new Uint8Array(0);case as.STRING:return"";default:return 0}}class us{constructor(e){this.info=e}prepare(){var e;if(!this.fieldNoToField){const t=null!==(e=this.info.fields)&&void 0!==e?e:[];this.fieldNoToField=new Map(t.map((e=>[e.no,e])))}}read(e,t,a,s){this.prepare();const n=void 0===s?e.len:e.pos+s;for(;e.pos<n;){const[s,n]=e.tag(),r=this.fieldNoToField.get(s);if(!r){let r=a.readUnknownField;if("throw"==r)throw new Error(`Unknown field ${s} (wire type ${n}) for ${this.info.typeName}`);let i=e.skip(n);!1!==r&&(!0===r?xa.onRead:r)(this.info.typeName,t,s,n,i);continue}let i=t,o=r.repeat,l=r.localName;switch(r.oneof&&(i=i[r.oneof],i.oneofKind!==l&&(i=t[r.oneof]={oneofKind:l})),r.kind){case"scalar":case"enum":let t="enum"==r.kind?as.INT32:r.T,s="scalar"==r.kind?r.L:void 0;if(o){let a=i[l];if(n==Ea.LengthDelimited&&t!=as.STRING&&t!=as.BYTES){let n=e.uint32()+e.pos;for(;e.pos<n;)a.push(this.scalar(e,t,s))}else a.push(this.scalar(e,t,s))}else i[l]=this.scalar(e,t,s);break;case"message":if(o){let t=i[l],s=r.T().internalBinaryRead(e,e.uint32(),a);t.push(s)}else i[l]=r.T().internalBinaryRead(e,e.uint32(),a,i[l]);break;case"map":let[c,h]=this.mapEntry(r,e,a);i[l][c]=h}}}mapEntry(e,t,a){let s,n,r=t.uint32(),i=t.pos+r;for(;t.pos<i;){let[r,i]=t.tag();switch(r){case 1:s=e.K==as.BOOL?t.bool().toString():this.scalar(t,e.K,ss.STRING);break;case 2:switch(e.V.kind){case"scalar":n=this.scalar(t,e.V.T,e.V.L);break;case"enum":n=t.int32();break;case"message":n=e.V.T().internalBinaryRead(t,t.uint32(),a)}break;default:throw new Error(`Unknown field ${r} (wire type ${i}) in map entry for ${this.info.typeName}#${e.name}`)}}if(void 0===s){let t=ds(e.K);s=e.K==as.BOOL?t.toString():t}if(void 0===n)switch(e.V.kind){case"scalar":n=ds(e.V.T,e.V.L);break;case"enum":n=0;break;case"message":n=e.V.T().create()}return[s,n]}scalar(e,t,a){switch(t){case as.INT32:return e.int32();case as.STRING:return e.string();case as.BOOL:return e.bool();case as.DOUBLE:return e.double();case as.FLOAT:return e.float();case as.INT64:return ls(e.int64(),a);case as.UINT64:return ls(e.uint64(),a);case as.FIXED64:return ls(e.fixed64(),a);case as.FIXED32:return e.fixed32();case as.BYTES:return e.bytes();case as.UINT32:return e.uint32();case as.SFIXED32:return e.sfixed32();case as.SFIXED64:return ls(e.sfixed64(),a);case as.SINT32:return e.sint32();case as.SINT64:return ls(e.sint64(),a)}}}class fs{constructor(e){this.info=e}prepare(){if(!this.fields){const e=this.info.fields?this.info.fields.concat():[];this.fields=e.sort(((e,t)=>e.no-t.no))}}write(e,t,a){this.prepare();for(const s of this.fields){let n,r,i=s.repeat,o=s.localName;if(s.oneof){const t=e[s.oneof];if(t.oneofKind!==o)continue;n=t[o],r=!0}else n=e[o],r=!1;switch(s.kind){case"scalar":case"enum":let e="enum"==s.kind?as.INT32:s.T;if(i)if(Ka(Array.isArray(n)),i==ns.PACKED)this.packed(t,e,s.no,n);else for(const a of n)this.scalar(t,e,s.no,a,!0);else void 0===n?Ka(s.opt):this.scalar(t,e,s.no,n,r||s.opt);break;case"message":if(i){Ka(Array.isArray(n));for(const e of n)this.message(t,a,s.T(),s.no,e)}else this.message(t,a,s.T(),s.no,n);break;case"map":Ka("object"==typeof n&&null!==n);for(const[e,r]of Object.entries(n))this.mapEntry(t,a,s,e,r)}}let s=a.writeUnknownFields;!1!==s&&(!0===s?xa.onWrite:s)(this.info.typeName,e,t)}mapEntry(e,t,a,s,n){e.tag(a.no,Ea.LengthDelimited),e.fork();let r=s;switch(a.K){case as.INT32:case as.FIXED32:case as.UINT32:case as.SFIXED32:case as.SINT32:r=Number.parseInt(s);break;case as.BOOL:Ka("true"==s||"false"==s),r="true"==s}switch(this.scalar(e,a.K,1,r,!0),a.V.kind){case"scalar":this.scalar(e,a.V.T,2,n,!0);break;case"enum":this.scalar(e,as.INT32,2,n,!0);break;case"message":this.message(e,t,a.V.T(),2,n)}e.join()}message(e,t,a,s,n){void 0!==n&&(a.internalBinaryWrite(n,e.tag(s,Ea.LengthDelimited).fork(),t),e.join())}scalar(e,t,a,s,n){let[r,i,o]=this.scalarInfo(t,s);o&&!n||(e.tag(a,r),e[i](s))}packed(e,t,a,s){if(!s.length)return;Ka(t!==as.BYTES&&t!==as.STRING),e.tag(a,Ea.LengthDelimited),e.fork();let[,n]=this.scalarInfo(t);for(let t=0;t<s.length;t++)e[n](s[t]);e.join()}scalarInfo(e,t){let a,s=Ea.Varint,n=void 0===t,r=0===t;switch(e){case as.INT32:a="int32";break;case as.STRING:r=n||!t.length,s=Ea.LengthDelimited,a="string";break;case as.BOOL:r=!1===t,a="bool";break;case as.UINT32:a="uint32";break;case as.DOUBLE:s=Ea.Bit64,a="double";break;case as.FLOAT:s=Ea.Bit32,a="float";break;case as.INT64:r=n||Za.from(t).isZero(),a="int64";break;case as.UINT64:r=n||Pa.from(t).isZero(),a="uint64";break;case as.FIXED64:r=n||Pa.from(t).isZero(),s=Ea.Bit64,a="fixed64";break;case as.BYTES:r=n||!t.byteLength,s=Ea.LengthDelimited,a="bytes";break;case as.FIXED32:s=Ea.Bit32,a="fixed32";break;case as.SFIXED32:s=Ea.Bit32,a="sfixed32";break;case as.SFIXED64:r=n||Za.from(t).isZero(),s=Ea.Bit64,a="sfixed64";break;case as.SINT32:a="sint32";break;case as.SINT64:r=n||Za.from(t).isZero(),a="sint64"}return[s,a,n||r]}}function ps(e,t,a){let s,n,r=a;for(let a of e.fields){let e=a.localName;if(a.oneof){const i=r[a.oneof];if(null==(null==i?void 0:i.oneofKind))continue;if(s=i[e],n=t[a.oneof],n.oneofKind=i.oneofKind,null==s){delete n[e];continue}}else if(s=r[e],n=t,null==s)continue;switch(a.repeat&&(n[e].length=s.length),a.kind){case"scalar":case"enum":if(a.repeat)for(let t=0;t<s.length;t++)n[e][t]=s[t];else n[e]=s;break;case"message":let t=a.T();if(a.repeat)for(let a=0;a<s.length;a++)n[e][a]=t.create(s[a]);else void 0===n[e]?n[e]=t.create(s):t.mergePartial(n[e],s);break;case"map":switch(a.V.kind){case"scalar":case"enum":Object.assign(n[e],s);break;case"message":let t=a.V.T();for(let a of Object.keys(s))n[e][a]=t.create(s[a])}}}}const gs=Object.values;function ms(e,t,a){if(t===a)return!0;if(e!==as.BYTES)return!1;let s=t,n=a;if(s.length!==n.length)return!1;for(let e=0;e<s.length;e++)if(s[e]!=n[e])return!1;return!0}function bs(e,t,a){if(t.length!==a.length)return!1;for(let s=0;s<t.length;s++)if(!ms(e,t[s],a[s]))return!1;return!0}function ws(e,t,a){if(t.length!==a.length)return!1;for(let s=0;s<t.length;s++)if(!e.equals(t[s],a[s]))return!1;return!0}class _s{constructor(e,t,a){this.defaultCheckDepth=16,this.typeName=e,this.fields=t.map(rs),this.options=null!=a?a:{},this.messagePrototype=Object.defineProperty({},es,{value:this}),this.refTypeCheck=new os(this),this.refJsonReader=new cs(this),this.refJsonWriter=new hs(this),this.refBinReader=new us(this),this.refBinWriter=new fs(this)}create(e){let t=function(e){const t=e.messagePrototype?Object.create(e.messagePrototype):Object.defineProperty({},es,{value:e});for(let a of e.fields){let e=a.localName;if(!a.opt)if(a.oneof)t[a.oneof]={oneofKind:void 0};else if(a.repeat)t[e]=[];else switch(a.kind){case"scalar":t[e]=ds(a.T,a.L);break;case"enum":t[e]=0;break;case"map":t[e]={}}}return t}(this);return void 0!==e&&ps(this,t,e),t}clone(e){let t=this.create();return ps(this,t,e),t}equals(e,t){return function(e,t,a){if(t===a)return!0;if(!t||!a)return!1;for(let s of e.fields){let e=s.localName,n=s.oneof?t[s.oneof][e]:t[e],r=s.oneof?a[s.oneof][e]:a[e];switch(s.kind){case"enum":case"scalar":let e="enum"==s.kind?as.INT32:s.T;if(!(s.repeat?bs(e,n,r):ms(e,n,r)))return!1;break;case"map":if(!("message"==s.V.kind?ws(s.V.T(),gs(n),gs(r)):bs("enum"==s.V.kind?as.INT32:s.V.T,gs(n),gs(r))))return!1;break;case"message":let t=s.T();if(!(s.repeat?ws(t,n,r):t.equals(n,r)))return!1}}return!0}(this,e,t)}is(e,t=this.defaultCheckDepth){return this.refTypeCheck.is(e,t,!1)}isAssignable(e,t=this.defaultCheckDepth){return this.refTypeCheck.is(e,t,!0)}mergePartial(e,t){ps(this,e,t)}fromBinary(e,t){let a=function(e){return e?Object.assign(Object.assign({},Ma),e):Ma}(t);return this.internalBinaryRead(a.readerFactory(e),e.byteLength,a)}fromJson(e,t){return this.internalJsonRead(e,function(e){return e?Object.assign(Object.assign({},Qa),e):Qa}(t))}fromJsonString(e,t){let a=JSON.parse(e);return this.fromJson(a,t)}toJson(e,t){return this.internalJsonWrite(e,function(e){return e?Object.assign(Object.assign({},Ya),e):Ya}(t))}toJsonString(e,t){var a;let s=this.toJson(e,t);return JSON.stringify(s,null,null!==(a=null==t?void 0:t.prettySpaces)&&void 0!==a?a:0)}toBinary(e,t){let a=function(e){return e?Object.assign(Object.assign({},Wa),e):Wa}(t);return this.internalBinaryWrite(e,a.writerFactory(),a).finish()}internalJsonRead(e,t,a){if(null!==e&&"object"==typeof e&&!Array.isArray(e)){let s=null!=a?a:this.create();return this.refJsonReader.read(e,s,t),s}throw new Error(`Unable to parse message ${this.typeName} from JSON ${Ta(e)}.`)}internalJsonWrite(e,t){return this.refJsonWriter.write(e,t)}internalBinaryWrite(e,t,a){return this.refBinWriter.write(e,t,a),t}internalBinaryRead(e,t,a,s){let n=null!=s?s:this.create();return this.refBinReader.read(e,n,a,t),n}}const ys=new a("ðŸ“º BiliBili: ðŸŒ Global v0.7.0(1008) request");let ks;const vs=new URL($request.url);ys.log(`âš  url: ${vs.toJSON()}`,"");const Ns=$request.method,Ts=vs.hostname,Is=vs.pathname,Ss=vs.pathname.split("/").filter(Boolean);ys.log(`âš  METHOD: ${Ns}, HOST: ${Ts}, PATH: ${Is}`,"");const xs=($request.headers?.["Content-Type"]??$request.headers?.["content-type"])?.split(";")?.[0];function Es(e={}){ys.log("â˜‘ï¸ Determine Response Availability","");const t=(e?.headers?.["Content-Type"]??e?.headers?.["content-type"])?.split(";")?.[0];ys.log("ðŸš§ Determine Response Availability",`FORMAT: ${t}`,"");let a=!0;if(200===e?.statusCode)switch(t){case"application/grpc":case"application/grpc+proto":switch(e?.headers?.["Grpc-Message"]??e?.headers?.["grpc-message"]){case"0":a=!0;break;case void 0:a=!(parseInt(e?.headers?.["content-length"]??e?.headers?.["Content-Length"])<1200);break;default:a=!1}break;case"text/json":case"application/json":switch(e?.headers?.["bili-status-code"]){case"0":case void 0:let t=JSON.parse(e?.body).data;switch(e?.headers?.idc){case"sgp001":case"sgp002":switch(t?.limit){case"":case void 0:a=!0;break;default:a=!1}break;default:switch(t?.video_info?.code){case 0:default:a=!0;break;case void 0:a=!1}if(void 0===t?.dialog?.code)a=!0;else a=!1}break;default:a=!1}break;case"text/html":a=!0}else a=!1;return ys.log("âœ… Determine Response Availability",`isAvailable:${a}`,""),a}async function As(e={},t={},a=[],s=[]){ys.log("â˜‘ï¸ availableFetch",`availableLocales: ${s}`,""),s=s.filter((e=>a.includes(e)));let n="";return n=s[Math.floor(Math.random()*s.length)],e.policy=t[n],ys.log("âœ… availableFetch",`locale: ${n}`,""),e}async function Os(e={},t={},a=[]){ys.log("â˜‘ï¸ mutiFetch",`locales: ${a}`,"");let s={};await Promise.allSettled(a.map((async a=>{e.policy=t[a],ys.isQuanX()&&(e.body=e.bodyBytes),s[a]=await ys.fetch(e)})));for(let e in s)Es(s[e])||delete s[e];let n=Object.keys(s);ys.log("â˜‘ï¸ mutiFetch",`availableLocales: ${n}`,"");let r=n[Math.floor(Math.random()*n.length)];e.policy=t[r];let i=s[r];return ys.log("âœ… mutiFetch",`locale: ${r}`,""),{request:e,response:i}}function Bs(e="",t=" "){ys.log("âš  Check Search Keyword",`Original Keyword: ${e}`,"");let a,s=e?.split(t);switch(ys.log("ðŸš§ Check Search Keyword",`keywords: ${s}`,""),[...s].pop()){case"CN":case"cn":case"CHN":case"chn":case"ä¸­å›½":case"ä¸­":case"ðŸ‡¨ðŸ‡³":a="CHN",s.pop(),e=s.join(t);break;case"HK":case"hk":case"HKG":case"hkg":case"æ¸¯":case"é¦™æ¸¯":case"ðŸ‡­ðŸ‡°":a="HKG",s.pop(),e=s.join(t);break;case"æ¾³":case"æ¾³é—¨":case"ðŸ‡²ðŸ‡´":a="MAC",s.pop(),e=s.join(t);break;case"TW":case"tw":case"TWN":case"å°":case"å°æ¹¾":case"ðŸ‡¹ðŸ‡¼":a="TWN",s.pop(),e=s.join(t);break;case"USA":case"ç¾Žå›½":case"ðŸ‡ºðŸ‡¸":a="USA",s.pop(),e=s.join(t);break;case"SG":case"sg":case"SGP":case"æ–°åŠ å¡":case"ðŸ‡¸ðŸ‡¬":a="SGP",s.pop(),e=s.join(t);break;case"TH":case"th":case"THA":case"æ³°":case"æ³°å›½":case"ðŸ‡¹ðŸ‡­":a="THA",s.pop(),e=s.join(t);break;case"MYS":case"é©¬æ¥è¥¿äºš":case"ðŸ‡²ðŸ‡¾":a="MYS",s.pop(),e=s.join(t)}return ys.log("ðŸŽ‰ Check Search Keyword",`Keyword: ${e}, Locale: ${a}`,""),{keyword:e,locale:a}}ys.log(`âš  FORMAT: ${xs}`,""),(async()=>{const{Settings:e,Caches:t,Configs:a}=c("BiliBili","Global",l);switch(ys.log(`âš  Settings.Switch: ${e?.Switch}`,""),e.Switch){case!0:default:let a={code:0,message:"0",data:{}},r={seasonTitle:vs.searchParams.get("season_title"),seasonId:parseInt(vs.searchParams.get("season_id"),10)||void 0,epId:parseInt(vs.searchParams.get("ep_id"),10)||void 0,mId:parseInt(vs.searchParams.get("mid")||vs.searchParams.get("vmid"),10)||void 0,evaluate:void 0,keyword:vs.searchParams.get("keyword"),locale:vs.searchParams.get("locale"),locales:[],type:"UGC"};switch(Ns){case"POST":case"PUT":case"PATCH":case"DELETE":switch(xs){case void 0:case"application/x-www-form-urlencoded":case"text/plain":default:case"application/x-mpegURL":case"application/x-mpegurl":case"application/vnd.apple.mpegurl":case"audio/mpegurl":case"text/xml":case"text/html":case"text/plist":case"application/xml":case"application/plist":case"application/x-plist":case"text/vtt":case"application/vtt":case"text/json":case"application/json":break;case"application/protobuf":case"application/x-protobuf":case"application/vnd.google.protobuf":case"application/grpc":case"application/grpc+proto":case"application/octet-stream":let i=ys.isQuanX()?new Uint8Array($request.bodyBytes??[]):$request.body??new Uint8Array;switch(xs){case"application/protobuf":case"application/x-protobuf":case"application/vnd.google.protobuf":break;case"application/grpc":case"application/grpc+proto":let o=i.slice(0,5);switch(a=i.slice(5),o?.[0]){case 0:break;case 1:a=Na.ungzip(a),o[0]=0}switch(Ts){case"grpc.biliapi.net":case"app.bilibili.com":var s;switch(function(e){e[e.NOCODE=0]="NOCODE",e[e.CODE264=1]="CODE264",e[e.CODE265=2]="CODE265",e[e.CODEAV1=3]="CODEAV1"}(s||(s={})),Ss?.[0]){case"bilibili.app.viewunite.v1.View":if("View"===Ss?.[1]){class e extends _s{constructor(){super("bilibili.app.viewunite.v1.ViewReq",[{no:1,name:"aid",kind:"scalar",T:4,L:2},{no:2,name:"bvid",kind:"scalar",T:9},{no:3,name:"from",kind:"scalar",T:9},{no:4,name:"spmid",kind:"scalar",T:9},{no:5,name:"from_spmid",kind:"scalar",T:9},{no:6,name:"session_id",kind:"scalar",T:9},{no:8,name:"track_id",kind:"scalar",T:9},{no:9,name:"extra_content",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:10,name:"play_mode",kind:"scalar",T:9},{no:12,name:"biz_extra",kind:"scalar",T:9},{no:13,name:"ad_extra",kind:"scalar",T:9}])}}const s=new e;let n=s.fromBinary(a);ys.log(`ðŸš§ data: ${JSON.stringify(n)}`,""),a=s.toBinary(n),r.seasonId=parseInt(n?.extraContent?.season_id,10)||r.seasonId,r.epId=parseInt(n?.extraContent.ep_id,10)||r.epId,(r.seasonId||r.epId)&&(r.type="PGC"),t.ss.has(r.seasonId)?r.locales=t.ss.get(r.seasonId):t.ep.has(r.epId)&&(r.locales=t.ep.get(r.epId))}break;case"bilibili.app.playerunite.v1.Player":class i extends _s{constructor(){super("bilibili.playershared.VideoVod",[{no:1,name:"aid",kind:"scalar",T:5},{no:2,name:"cid",kind:"scalar",T:5},{no:3,name:"qn",kind:"scalar",T:4,L:2},{no:4,name:"fnver",kind:"scalar",T:5},{no:5,name:"fnval",kind:"scalar",T:5},{no:6,name:"download",kind:"scalar",T:13},{no:7,name:"force_host",kind:"scalar",T:5},{no:8,name:"fourk",kind:"scalar",T:8},{no:9,name:"prefer_codec_type",kind:"enum",T:()=>["bilibili.playershared.CodeType",s]},{no:10,name:"voice_balance",kind:"scalar",T:4,L:2}])}create(e){const t={aid:0,cid:0,qn:0,fnver:0,fnval:0,download:0,forceHost:0,fourk:!1,preferCodecType:0,voiceBalance:0};return globalThis.Object.defineProperty(t,es,{enumerable:!1,value:this}),void 0!==e&&ps(this,t,e),t}internalBinaryRead(e,t,a,s){let n=s??this.create(),r=e.pos+t;for(;e.pos<r;){let[t,s]=e.tag();switch(t){case 1:n.aid=e.int32();break;case 2:n.cid=e.int32();break;case 3:n.qn=e.uint64().toNumber();break;case 4:n.fnver=e.int32();break;case 5:n.fnval=e.int32();break;case 6:n.download=e.uint32();break;case 7:n.forceHost=e.int32();break;case 8:n.fourk=e.bool();break;case 9:n.preferCodecType=e.int32();break;case 10:n.voiceBalance=e.uint64().toNumber();break;default:let r=a.readUnknownField;if("throw"===r)throw new globalThis.Error(`Unknown field ${t} (wire type ${s}) for ${this.typeName}`);let i=e.skip(s);!1!==r&&(!0===r?xa.onRead:r)(this.typeName,n,t,s,i)}}return n}internalBinaryWrite(e,t,a){0!==e.aid&&t.tag(1,Ea.Varint).int32(e.aid),0!==e.cid&&t.tag(2,Ea.Varint).int32(e.cid),0!==e.qn&&t.tag(3,Ea.Varint).uint64(e.qn),0!==e.fnver&&t.tag(4,Ea.Varint).int32(e.fnver),0!==e.fnval&&t.tag(5,Ea.Varint).int32(e.fnval),0!==e.download&&t.tag(6,Ea.Varint).uint32(e.download),0!==e.forceHost&&t.tag(7,Ea.Varint).int32(e.forceHost),!1!==e.fourk&&t.tag(8,Ea.Varint).bool(e.fourk),0!==e.preferCodecType&&t.tag(9,Ea.Varint).int32(e.preferCodecType),0!==e.voiceBalance&&t.tag(10,Ea.Varint).uint64(e.voiceBalance);let s=a.writeUnknownFields;return!1!==s&&(1==s?xa.onWrite:s)(this.typeName,e,t),t}}const o=new i;switch(Ss?.[1]){case"PlayViewUnite":{class s extends _s{constructor(){super("bilibili.app.playerunite.v1.PlayViewUniteReq",[{no:1,name:"vod",kind:"message",T:()=>o},{no:2,name:"spmid",kind:"scalar",T:9},{no:3,name:"from_spmid",kind:"scalar",T:9},{no:4,name:"extra_content",kind:"map",K:9,V:{kind:"scalar",T:9}}])}create(e){const t={spmid:"",fromSpmid:"",extraContent:{}};return globalThis.Object.defineProperty(t,es,{enumerable:!1,value:this}),void 0!==e&&ps(this,t,e),t}internalBinaryRead(e,t,a,s){let n=s??this.create(),r=e.pos+t;for(;e.pos<r;){let[t,s]=e.tag();switch(t){case 1:n.vod=o.internalBinaryRead(e,e.uint32(),a,n.vod);break;case 2:n.spmid=e.string();break;case 3:n.fromSpmid=e.string();break;case 4:this.binaryReadMap4(n.extraContent,e,a);break;default:let r=a.readUnknownField;if("throw"===r)throw new globalThis.Error(`Unknown field ${t} (wire type ${s}) for ${this.typeName}`);let i=e.skip(s);!1!==r&&(!0===r?xa.onRead:r)(this.typeName,n,t,s,i)}}return n}binaryReadMap4(e,t,a){let s,n,r=t.uint32(),i=t.pos+r;for(;t.pos<i;){let[e,a]=t.tag();switch(e){case 1:s=t.string();break;case 2:n=t.string();break;default:throw new globalThis.Error("unknown map entry field for field bilibili.app.playerunite.v1.PlayViewUniteReq.extra_content")}}e[s??""]=n??""}internalBinaryWrite(e,t,a){e.vod&&o.internalBinaryWrite(e.vod,t.tag(1,Ea.LengthDelimited).fork(),a).join(),""!==e.spmid&&t.tag(2,Ea.LengthDelimited).string(e.spmid),""!==e.fromSpmid&&t.tag(3,Ea.LengthDelimited).string(e.fromSpmid);for(let a of Object.keys(e.extraContent))t.tag(4,Ea.LengthDelimited).fork().tag(1,Ea.LengthDelimited).string(a).tag(2,Ea.LengthDelimited).string(e.extraContent[a]).join();let s=a.writeUnknownFields;return!1!==s&&(1==s?xa.onWrite:s)(this.typeName,e,t),t}}const n=new s;let i=n.fromBinary(a);ys.log(`ðŸš§ data: ${JSON.stringify(i)}`,""),i.vod.forceHost=e?.ForceHost??1,a=n.toBinary(i),r.seasonId=parseInt(i?.extraContent?.season_id,10)||r.seasonId,r.epId=parseInt(i?.extraContent.ep_id,10)||r.epId,(r.seasonId||r.epId)&&(r.type="PGC"),t.ss.has(r.seasonId)?r.locales=t.ss.get(r.seasonId):t.ep.has(r.epId)&&(r.locales=t.ep.get(r.epId));break}}break;case"bilibili.app.playurl.v1.PlayURL":case"bilibili.app.nativeact.v1.NativeAct":case"bilibili.app.interface.v1.Search":Ss?.[1];break;case"bilibili.pgc.gateway.player.v2.PlayURL":var n;!function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.RELATED_EP=1]="RELATED_EP",e[e.HE=2]="HE",e[e.SKIP=3]="SKIP"}(n||(n={}));class l extends _s{constructor(){super("bilibili.pgc.gateway.player.v2.DataControl",[{no:1,name:"need_watch_progress",kind:"scalar",T:8}])}create(e){const t={needWatchProgress:!1};return globalThis.Object.defineProperty(t,es,{enumerable:!1,value:this}),void 0!==e&&ps(this,t,e),t}internalBinaryRead(e,t,a,s){let n=s??this.create(),r=e.pos+t;for(;e.pos<r;){let[t,s]=e.tag();if(1===t)n.needWatchProgress=e.bool();else{let r=a.readUnknownField;if("throw"===r)throw new globalThis.Error(`Unknown field ${t} (wire type ${s}) for ${this.typeName}`);let i=e.skip(s);!1!==r&&(!0===r?xa.onRead:r)(this.typeName,n,t,s,i)}}return n}internalBinaryWrite(e,t,a){!1!==e.needWatchProgress&&t.tag(1,Ea.Varint).bool(e.needWatchProgress);let s=a.writeUnknownFields;return!1!==s&&(1==s?xa.onWrite:s)(this.typeName,e,t),t}}const c=new l;class h extends _s{constructor(){super("bilibili.pgc.gateway.player.v2.SceneControl",[{no:1,name:"fav_playlist",kind:"scalar",T:8},{no:2,name:"small_window",kind:"scalar",T:8},{no:3,name:"pip",kind:"scalar",T:8},{no:4,name:"was_he_inline",kind:"scalar",T:8},{no:5,name:"is_need_trial",kind:"scalar",T:8}])}create(e){const t={favPlaylist:!1,smallWindow:!1,pip:!1,wasHeInline:!1,isNeedTrial:!1};return globalThis.Object.defineProperty(t,es,{enumerable:!1,value:this}),void 0!==e&&ps(this,t,e),t}internalBinaryRead(e,t,a,s){let n=s??this.create(),r=e.pos+t;for(;e.pos<r;){let[t,s]=e.tag();switch(t){case 1:n.favPlaylist=e.bool();break;case 2:n.smallWindow=e.bool();break;case 3:n.pip=e.bool();break;case 4:n.wasHeInline=e.bool();break;case 5:n.isNeedTrial=e.bool();break;default:let r=a.readUnknownField;if("throw"===r)throw new globalThis.Error(`Unknown field ${t} (wire type ${s}) for ${this.typeName}`);let i=e.skip(s);!1!==r&&(!0===r?xa.onRead:r)(this.typeName,n,t,s,i)}}return n}internalBinaryWrite(e,t,a){!1!==e.favPlaylist&&t.tag(1,Ea.Varint).bool(e.favPlaylist),!1!==e.smallWindow&&t.tag(2,Ea.Varint).bool(e.smallWindow),!1!==e.pip&&t.tag(3,Ea.Varint).bool(e.pip),!1!==e.wasHeInline&&t.tag(4,Ea.Varint).bool(e.wasHeInline),!1!==e.isNeedTrial&&t.tag(5,Ea.Varint).bool(e.isNeedTrial);let s=a.writeUnknownFields;return!1!==s&&(1==s?xa.onWrite:s)(this.typeName,e,t),t}}const d=new h;switch(Ss?.[1]){case"PlayView":{class i extends _s{constructor(){super("bilibili.pgc.gateway.player.v2.PlayViewReq",[{no:1,name:"ep_id",kind:"scalar",opt:!0,T:3,L:2},{no:2,name:"cid",kind:"scalar",opt:!0,T:3,L:2},{no:3,name:"qn",kind:"scalar",T:3,L:2},{no:4,name:"fnver",kind:"scalar",opt:!0,T:5},{no:5,name:"fnval",kind:"scalar",T:5},{no:6,name:"download",kind:"scalar",opt:!0,T:13},{no:7,name:"force_host",kind:"scalar",opt:!0,T:5},{no:8,name:"fourk",kind:"scalar",opt:!0,T:8},{no:9,name:"spmid",kind:"scalar",opt:!0,T:9},{no:10,name:"from_spmid",kind:"scalar",opt:!0,T:9},{no:11,name:"teenagers_mode",kind:"scalar",opt:!0,T:5},{no:12,name:"prefer_codec_type",kind:"enum",T:()=>["bilibili.pgc.gateway.player.v2.CodeType",s]},{no:13,name:"is_preview",kind:"scalar",opt:!0,T:8},{no:14,name:"room_id",kind:"scalar",opt:!0,T:3,L:2},{no:15,name:"is_need_view_info",kind:"scalar",opt:!0,T:8},{no:16,name:"scene_control",kind:"message",T:()=>d},{no:17,name:"inline_scene",kind:"enum",opt:!0,T:()=>["bilibili.pgc.gateway.player.v2.InlineScene",n]},{no:18,name:"material_no",kind:"scalar",opt:!0,T:3,L:2},{no:19,name:"security_level",kind:"scalar",opt:!0,T:5},{no:20,name:"season_id",kind:"scalar",T:3,L:2},{no:21,name:"data_control",kind:"message",T:()=>c}])}create(e){const t={qn:0,fnval:0,preferCodecType:0,seasonId:0};return globalThis.Object.defineProperty(t,es,{enumerable:!1,value:this}),void 0!==e&&ps(this,t,e),t}internalBinaryRead(e,t,a,s){let n=s??this.create(),r=e.pos+t;for(;e.pos<r;){let[t,s]=e.tag();switch(t){case 1:n.epId=e.int64().toNumber();break;case 2:n.cid=e.int64().toNumber();break;case 3:n.qn=e.int64().toNumber();break;case 4:n.fnver=e.int32();break;case 5:n.fnval=e.int32();break;case 6:n.download=e.uint32();break;case 7:n.forceHost=e.int32();break;case 8:n.fourk=e.bool();break;case 9:n.spmid=e.string();break;case 10:n.fromSpmid=e.string();break;case 11:n.teenagersMode=e.int32();break;case 12:n.preferCodecType=e.int32();break;case 13:n.isPreview=e.bool();break;case 14:n.roomId=e.int64().toNumber();break;case 15:n.isNeedViewInfo=e.bool();break;case 16:n.sceneControl=d.internalBinaryRead(e,e.uint32(),a,n.sceneControl);break;case 17:n.inlineScene=e.int32();break;case 18:n.materialNo=e.int64().toNumber();break;case 19:n.securityLevel=e.int32();break;case 20:n.seasonId=e.int64().toNumber();break;case 21:n.dataControl=c.internalBinaryRead(e,e.uint32(),a,n.dataControl);break;default:let r=a.readUnknownField;if("throw"===r)throw new globalThis.Error(`Unknown field ${t} (wire type ${s}) for ${this.typeName}`);let i=e.skip(s);!1!==r&&(!0===r?xa.onRead:r)(this.typeName,n,t,s,i)}}return n}internalBinaryWrite(e,t,a){void 0!==e.epId&&t.tag(1,Ea.Varint).int64(e.epId),void 0!==e.cid&&t.tag(2,Ea.Varint).int64(e.cid),0!==e.qn&&t.tag(3,Ea.Varint).int64(e.qn),void 0!==e.fnver&&t.tag(4,Ea.Varint).int32(e.fnver),0!==e.fnval&&t.tag(5,Ea.Varint).int32(e.fnval),void 0!==e.download&&t.tag(6,Ea.Varint).uint32(e.download),void 0!==e.forceHost&&t.tag(7,Ea.Varint).int32(e.forceHost),void 0!==e.fourk&&t.tag(8,Ea.Varint).bool(e.fourk),void 0!==e.spmid&&t.tag(9,Ea.LengthDelimited).string(e.spmid),void 0!==e.fromSpmid&&t.tag(10,Ea.LengthDelimited).string(e.fromSpmid),void 0!==e.teenagersMode&&t.tag(11,Ea.Varint).int32(e.teenagersMode),0!==e.preferCodecType&&t.tag(12,Ea.Varint).int32(e.preferCodecType),void 0!==e.isPreview&&t.tag(13,Ea.Varint).bool(e.isPreview),void 0!==e.roomId&&t.tag(14,Ea.Varint).int64(e.roomId),void 0!==e.isNeedViewInfo&&t.tag(15,Ea.Varint).bool(e.isNeedViewInfo),e.sceneControl&&d.internalBinaryWrite(e.sceneControl,t.tag(16,Ea.LengthDelimited).fork(),a).join(),void 0!==e.inlineScene&&t.tag(17,Ea.Varint).int32(e.inlineScene),void 0!==e.materialNo&&t.tag(18,Ea.Varint).int64(e.materialNo),void 0!==e.securityLevel&&t.tag(19,Ea.Varint).int32(e.securityLevel),0!==e.seasonId&&t.tag(20,Ea.Varint).int64(e.seasonId),e.dataControl&&c.internalBinaryWrite(e.dataControl,t.tag(21,Ea.LengthDelimited).fork(),a).join();let s=a.writeUnknownFields;return!1!==s&&(1==s?xa.onWrite:s)(this.typeName,e,t),t}}const o=new i;let l=o.fromBinary(a);ys.log(`ðŸš§ data: ${JSON.stringify(l)}`,""),l.forceHost=e?.ForceHost??1,a=o.toBinary(l),r.seasonId=l?.seasonId,r.epId=l?.epId,r.type="PGC",t.ss.has(r.seasonId)?r.locales=t.ss.get(r.seasonId):t.ep.has(r.epId)&&(r.locales=t.ep.get(r.epId));break}}break;case"bilibili.polymer.app.search.v1.Search":switch(Ss?.[1]){case"SearchAll":{class e extends _s{constructor(){super("bilibili.polymer.app.search.v1.SearchAllRequest",[{no:1,name:"keyword",kind:"scalar",T:9}])}create(e){const t={keyword:""};return globalThis.Object.defineProperty(t,es,{enumerable:!1,value:this}),void 0!==e&&ps(this,t,e),t}internalBinaryRead(e,t,a,s){let n=s??this.create(),r=e.pos+t;for(;e.pos<r;){let[t,s]=e.tag();if(1===t)n.keyword=e.string();else{let r=a.readUnknownField;if("throw"===r)throw new globalThis.Error(`Unknown field ${t} (wire type ${s}) for ${this.typeName}`);let i=e.skip(s);!1!==r&&(!0===r?xa.onRead:r)(this.typeName,n,t,s,i)}}return n}internalBinaryWrite(e,t,a){""!==e.keyword&&t.tag(1,Ea.LengthDelimited).string(e.keyword);let s=a.writeUnknownFields;return!1!==s&&(1==s?xa.onWrite:s)(this.typeName,e,t),t}}const t=new e;let s=t.fromBinary(a);ys.log(`ðŸš§ data: ${JSON.stringify(s)}`,""),({keyword:r.keyword,locale:r.locale}=Bs(s?.keyword)),s.keyword=r.keyword,ys.log(`ðŸš§ data: ${JSON.stringify(s)}`,""),a=t.toBinary(s);break}case"SearchByType":{class e extends _s{constructor(){super("bilibili.polymer.app.search.v1.SearchByTypeRequest",[{no:1,name:"type",kind:"scalar",T:5},{no:2,name:"keyword",kind:"scalar",T:9}])}create(e){const t={type:0,keyword:""};return globalThis.Object.defineProperty(t,es,{enumerable:!1,value:this}),void 0!==e&&ps(this,t,e),t}internalBinaryRead(e,t,a,s){let n=s??this.create(),r=e.pos+t;for(;e.pos<r;){let[t,s]=e.tag();switch(t){case 1:n.type=e.int32();break;case 2:n.keyword=e.string();break;default:let r=a.readUnknownField;if("throw"===r)throw new globalThis.Error(`Unknown field ${t} (wire type ${s}) for ${this.typeName}`);let i=e.skip(s);!1!==r&&(!0===r?xa.onRead:r)(this.typeName,n,t,s,i)}}return n}internalBinaryWrite(e,t,a){0!==e.type&&t.tag(1,Ea.Varint).int32(e.type),""!==e.keyword&&t.tag(2,Ea.LengthDelimited).string(e.keyword);let s=a.writeUnknownFields;return!1!==s&&(1==s?xa.onWrite:s)(this.typeName,e,t),t}}const t=new e;let s=t.fromBinary(a);ys.log(`ðŸš§ data: ${JSON.stringify(s)}`,""),({keyword:r.keyword,locale:r.locale}=Bs(s?.keyword)),s.keyword=r.keyword,ys.log(`ðŸš§ data: ${JSON.stringify(s)}`,""),a=t.toBinary(s);break}}}}i=function({header:e,body:t},a){console.log("â˜‘ï¸ Add gRPC Header","");const s="gzip"==a?1:"identity"==a||null==a?0:e?.[0]??0,n=function(e){let t=new ArrayBuffer(4);return new DataView(t).setUint32(0,e,!1),new Uint8Array(t)}(t.length);"gzip"==a&&(t=pako.gzip(t));let r=new Uint8Array(e.length+t.length);return r.set([s],0),r.set(n,1),r.set(t,5),console.log("âœ… Add gRPC Header",""),r}({header:o,body:a})}$request.body=i}case"GET":case"HEAD":case"OPTIONS":default:switch(Ts){case"www.bilibili.com":if("bangumi"===Ss?.[0])if("play"===Ss?.[1]){const e=/ss(?<seasonId>[0-9]+)|ep(?<epId>[0-9]+)/;({seasonId:r.seasonId,epId:r.epId}=Ss?.[2].match(e)?.groups),r.seasonId=parseInt(r.seasonId,10)||r.seasonId,r.epId=parseInt(r.epId,10)||r.epId,t.ss.has(r.seasonId)?r.locales=t.ss.get(r.seasonId):t.ep.has(r.epId)&&(r.locales=t.ep.get(r.epId))}break;case"search.bilibili.com":if("/all"===Is)({keyword:r.keyword,locale:r.locale}=Bs(r.keyword)),vs.searchParams.set("keyword",r.keyword);break;case"app.bilibili.com":case"app.biliapi.net":switch(Is){case"/x/v2/splash/show":case"/x/v2/splash/list":case"/x/v2/splash/brand/list":case"/x/v2/splash/event/list2":case"/x/v2/feed/index":case"/x/v2/feed/index/story":case"/x/v2/search/square":break;case"/x/v2/search":case"/x/v2/search/type":({keyword:r.keyword,locale:r.locale}=Bs(r.keyword)),vs.searchParams.set("keyword",r.keyword);break;case"/x/v2/space":switch(r.mId){case 928123:case 15773384:default:r.locales=["CHN"];break;case 11783021:case 1988098633:case 2042149112:r.locales=e.Locales.filter((e=>"CHN"!==e))}}break;case"api.bilibili.com":case"api.biliapi.net":switch(Is){case"/pgc/player/api/playurl":case"/pgc/player/web/playurl":case"/pgc/player/web/v2/playurl":case"/pgc/player/web/playurl/html5":case"/pgc/view/v2/app/season":case"/pgc/view/web/season":case"/pgc/view/pc/season":r.type="PGC",t.ss.has(r.seasonId)?r.locales=t.ss.get(r.seasonId):t.ep.has(r.epId)&&(r.locales=t.ep.get(r.epId));break;case"/pgc/page/bangumi":case"/pgc/page/cinema/tab":r.type="PGC";break;case"/x/player/wbi/playurl":break;case"/x/space/acc/info":case"/x/space/wbi/acc/info":switch(r.mId){case 928123:case 15773384:default:r.locales=["CHN"];break;case 11783021:case 1988098633:case 2042149112:r.locales=e.Locales.filter((e=>"CHN"!==e))}break;case"/x/web-interface/search":case"/x/web-interface/search/all/v2":case"/x/web-interface/search/type":({keyword:r.keyword,locale:r.locale}=Bs(r.keyword)),vs.searchParams.set("keyword",r.keyword);break;case"/x/web-interface/wbi/search/all/v2":case"/x/web-interface/wbi/search/type":({keyword:r.keyword,locale:r.locale}=Bs(r.keyword,"+")),vs.searchParams.get("keyword",r.keyword)}}case"CONNECT":case"TRACE":}switch($request.url=vs.toString(),ys.log(`ðŸš§ ${ys.name}ï¼Œä¿¡æ¯ç»„, infoGroup: ${JSON.stringify(r)}`,""),Is){case"/bilibili.app.viewunite.v1.View/View":case"/pgc/view/v2/app/season":case"/pgc/view/web/season":case"/pgc/view/pc/season":if("PGC"===r.type)0!==r.locales.length?$request=await As($request,e.Proxies,e.Locales,r.locales):({request:$request}=await Os($request,e.Proxies,e.Locales));else ys.log("âš  ä¸æ˜¯ PGC, è·³è¿‡","");switch(ys.platform()){case"Shadowrocket":case"Quantumult X":delete $request.policy}break;case"/all":case"/bilibili.polymer.app.search.v1.Search/SearchAll":case"/bilibili.polymer.app.search.v1.Search/SearchByType":case"/x/web-interface/search":case"/x/web-interface/search/all/v2":case"/x/web-interface/search/type":case"/x/web-interface/wbi/search/all/v2":case"/x/web-interface/wbi/search/type":case"/x/v2/search":case"/x/v2/search/type":$request.policy=e.Proxies[r.locale];break;default:if("PGC"===r.type)0!==r.locales.length?$request=await As($request,e.Proxies,e.Locales,r.locales):({request:$request,response:ks}=await Os($request,e.Proxies,e.Locales));else ys.log("âš  ä¸æ˜¯ PGC, è·³è¿‡","")}if(!ks)switch(ys.platform()){case"Shadowrocket":case"Quantumult X":$request.policy&&(ks=await ys.fetch($request))}case!1:}})().catch((e=>ys.logErr(e))).finally((()=>{if(void 0===ks)ys.done($request);else ks.headers?.["Content-Encoding"]&&(ks.headers["Content-Encoding"]="identity"),ks.headers?.["content-encoding"]&&(ks.headers["content-encoding"]="identity"),ys.isQuanX()?(ks.status||(ks.status="HTTP/1.1 200 OK"),delete ks.headers?.["Content-Length"],delete ks.headers?.["content-length"],delete ks.headers?.["Transfer-Encoding"],ys.done(ks)):ys.done({response:ks})}));
